---
title: "Topic 16: Inference Practice"
tutorial:
  id: "InferencePractice.Topic16.AppliedStats"
  version: 1.0
output: 
  learnr::tutorial:
    progressive: TRUE
    
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
library(ggplot2)
library(dplyr)
library(learnr)
library(gradethis)


tutorial_options(exercise.timelimit = 60, exercise.checker = gradethis::grade_learnr)

```

## Topic 16: Inference Practice

###

In this workbook, you'll have an opportunity to practice a set of problems. Through this workbook you will still be provided with a set of guided questions for each problem. Think about the guiding questions and steps necessary to complete each task. On the associated homework problems you'll need to come up with these steps on your own. This workbook should prepare you for that.

###

For convenience, here is the [*standard errror decision tree*](www/StdErrorDecisionTree.pdf){target="_blank"}. For any problems involving hypothesis tests, assume the $\alpha = 0.05$ level of significance unless otherwise stated.

## Problem 1

**Problem 1:** The distribution of the number of eggs laid by a certain species of hen during their breeding period is 35 eggs with a standard deviation of 18.2. Suppose a group of researchers randomly samples 45 hens of this species, counts the number of eggs laid during their breeding period, and records a sample mean of 37 eggs. Find the probability of observing a sample of 45 hens whose mean number of eggs laid during the breeding period is at least 37. (In case of emergency, [see worked solution here](www/SampleInferenceProbSol.pdf))

```{r prob1-1, echo = FALSE}
question_radio(
  "To answer the question as asked, we should",
  answer("Construct a confidence interval"),
  answer("Conduct a hypothesis test"),
  answer("Compute a probability", correct = TRUE),
  answer("Find a required sample size"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob1-2, echo = FALSE}
question_radio(
  "How many groups are samples in this application representing?",
  answer("The sample was taken from a single population.", correct = TRUE),
  answer("Sample observations were collected from two populations."),
  answer("Sample observatons were collected from more than two populations."),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

```{r prob1-3, echo = FALSE}
question_radio(
  "Do we know the population standard deviation for number of eggs laid?",
  answer("Yes, the population standard deviation is known.", correct = TRUE),
  answer("No, the population standard deviation is not known."),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob1-4, echo = FALSE}
quiz(
  question_radio(
    "How should the standard error of the sampling distribution be computed?",
    answer("$\\displaystyle{S_E = \\sigma/\\sqrt{n}}$", correct = TRUE),
    answer("$\\displaystyle{S_E = s/\\sqrt{n}}$"),
    answer("$\\displaystyle{S_E = \\sigma_{\\text{diff}}/n_{\\text{diff}}}$"),
    answer("$\\displaystyle{S_E = s_{\\text{diff}}/\\sqrt{n_{\\text{diff}}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{\\sigma_1^2}{n_1} + \\frac{\\sigma_2^2}{n_2}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{s_1^2}{n_1} + \\frac{s_2^2}{n_2}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{p\\left(1 - p\\right)}{n}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{p_1\\left(1 - p_1\\right)}{n_1} + \\frac{p_2\\left(1 - p_2\\right)}{n_2}}}$"),
    allow_retry = TRUE,
    random_answer_order = TRUE
  ),
  question_radio(
    "Which distribution best describes the sampling distribution?",
    answer("A normal distribution", correct = TRUE),
    answer("A $t$-distribution with $n - 1$ degrees of freedom."),
    answer("A $t$-distribution with $n_1 + n_2 - 2$ degrees of freedom."),
    answer("A $t$-distribution with $n_{\\text{diff}} - 1$ degrees of freedom."),
    allow_retry = TRUE,
    random_answer_order = TRUE
  )
)
```

###

Use the code block below to compute the probability of observing a random sample of 45 hens from this species which lays an average of at least 37 eggs.
```{r prob1-5, exercise = TRUE}

```

```{r prob1-5-check}
grade_result(
  pass_if(~ (abs(.result - (1 - pnorm(37, 35, 18.2/sqrt(45)))) < 0.0005))
)
```

## Problem 2

**Problem 2:** A recent study looked at average ages of male and female inmates on Death Row. The random sample of 9 women and 14 men on death row resulted in the following: 

<center>
$\begin{array}{|c|c|c|} \hline & \text{Men} & \text{Women} \\ \hline
\bar{x} & 39 & 44\\ \hline
s & 4.5 & 6.2 \\ \hline \end{array}$
</center>

Conduct a hypothesis test to determine whether there is evidence to suggest that the men on Death Row are, on average, younger than women on Death Row. (In case of emergency, [see worked solution here](www/SampleInferenceDeathRow.pdf))

###

```{r prob2-1, echo = FALSE}
question_radio(
  "To answer the question as asked, we should",
  answer("Construct a confidence interval"),
  answer("Conduct a hypothesis test", correct = TRUE),
  answer("Compute a probability"),
  answer("Find a required sample size"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob2-2, echo = FALSE}
question_radio(
  "What is the level of significance associated with this test?",
  answer("$\\alpha = 0.01$"),
  answer("$\\alpha = 0.10$"),
  answer("$\\alpha = 0.05$", correct = TRUE),
  answer("The $p$-value"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob2-3, echo = FALSE}
question_radio(
  "Does this hypothesis test involve testing a statement about the mean ($\\mu$), a proportion ($p$), or something else?",
  answer("One or more means", correct = TRUE),
  answer("One or more proportions"),
  answer("Something else altogether"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob2-4, echo = FALSE}
question_radio(
  "How many groups are being compared in this test?",
  answer("The test involves only a single group"),
  answer("The test compares two groups", correct = TRUE),
  answer("The test compares more than two groups"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob2-5, echo = FALSE}
question_radio(
  "Which of the following are the hypotheses associated with this test?",
  answer("$\\begin{array}{ll} H_0: & \\mu_{\\text{men}} - \\mu_{\\text{women}} = 0\\\\ H_a: & \\mu_{\\text{men}} - \\mu_{\\text{women}} \\neq 0\\end{array}$"),
  answer("$\\begin{array}{ll} H_0: & \\mu_{\\text{men}} - \\mu_{\\text{women}} = 0\\\\ H_a: & \\mu_{\\text{men}} - \\mu_{\\text{women}} > 0\\end{array}$"),
  answer("$\\begin{array}{ll} H_0: & \\mu_{\\text{men}} - \\mu_{\\text{women}} = 0\\\\ H_a: & \\mu_{\\text{men}} - \\mu_{\\text{women}} < 0\\end{array}$", correct = TRUE),
  answer("$\\begin{array}{ll} H_0: & \\mu_{\\text{men}} \\neq \\mu_{\\text{women}}\\\\ H_a: & \\mu_{\\text{men}} = \\mu_{\\text{women}}\\end{array}$"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob2-6, echo = FALSE}
question_radio(
  "Do we know the population standard deviation(s), $\\sigma$, for age in each group?",
  answer("Yes, the population standard deviations are known.", message = "Oops. We are presented with a standard deviation in ages for each group, but those standard deviations belong only to the ages measured in each sample, not the population."),
  answer("No, the population standard deviations are not known.", correct = TRUE),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob2-7, echo = FALSE}
question_radio(
  "Are the observations in the two groups (males on Death Row and females on Death Row) paired?",
  answer("No. There is no reason to suggest that the prisoners are paired.", correct = TRUE),
  answer("Yes. Every male prisoner can be naturally paired to a female prisoner."),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob2-8, echo = FALSE}
quiz(
  question_radio(
    "Which standard error formula should be used in the computation of the test statistic?",
    answer("$\\displaystyle{S_E = \\sigma/\\sqrt{n}}$"),
    answer("$\\displaystyle{S_E = s/\\sqrt{n}}$"),
    answer("$\\displaystyle{S_E = \\sigma_{\\text{diff}}/n_{\\text{diff}}}$"),
    answer("$\\displaystyle{S_E = s_{\\text{diff}}/\\sqrt{n_{\\text{diff}}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{\\sigma_1^2}{n_1} + \\frac{\\sigma_2^2}{n_2}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{s_1^2}{n_1} + \\frac{s_2^2}{n_2}}}$", correct = TRUE),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{p\\left(1 - p\\right)}{n}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{p_1\\left(1 - p_1\\right)}{n_1} + \\frac{p_2\\left(1 - p_2\\right)}{n_2}}}$"),
    allow_retry = TRUE,
    random_answer_order = TRUE
  ),
  question_radio(
    "Which distribution does the test statistic follow for this hypothesis test?",
    answer("The normal distribution"),
    answer("The $t$-distribution with $n - 1$ degrees of freedom."),
    answer("The $t$-distribution with $n_1 + n_2 - 2$ degrees of freedom.", correct = TRUE),
    answer("The $t$-distribution with $n_{\\text{diff}} - 1$ degrees of freedom."),
    allow_retry = TRUE,
    random_answer_order = TRUE
  )
)
```

###

Now we'll begin building the test statistic. Use the code block below to input or compute the point estimate for our population parameter.
```{r prob2-9, exercise = TRUE}

```

```{r prob2-9-check}
grade_result(
  pass_if(~ (abs(.result) == 5))
)
```

###

Use the code block below to input or compute the null value.
```{r prob2-10, exercise = TRUE}

```

```{r prob2-10-check}
grade_result(
  pass_if(~ (.result == 0))
)
```

###

Use the code block below to input or compute the standard error.
```{r prob2-11, exercise = TRUE}

```

```{r prob2-11-check}
grade_result(
  pass_if(~ (abs(.result - sqrt((4.5^2/14) + (6.2^2/9))) < 0.01))
)
```

###

Use the code block below to input or compute the test statistic.
```{r prob2-12, exercise = TRUE}

```

```{r prob2-12-check}
grade_result(
  pass_if(~ (abs(abs(.result) - ((5 - 0)/sqrt((4.5^2/14) + (6.2^2/9)))) < 0.01))
)
```

###

Use the code block below to compute the $p$-value associated with this test.
```{r prob2-13, exercise = TRUE}

```

```{r prob2-13-check}
grade_result(
  pass_if(~ (abs(.result - (1 - pt(((5 - 0)/sqrt((4.5^2/14) + (6.2^2/9))), df = 14 + 9 - 2))) < 0.0005))
)
```

###

Answer the following to complete the hypothesis test.

```{r prob2-14, echo = FALSE}
quiz(
  question_radio(
    "What is the result of the test?",
    answer("Since $p \\geq \\alpha$, we do not have enough evidence to reject the null hypothesis."),
  answer("Since $p \\geq \\alpha$, we accept the null hypothesis."),
  answer("Since $p < \\alpha$, we reject the null hypothesis and accept the alternative hypothesis.", correct = TRUE),
  answer("Since $p < \\alpha$, we fail to reject the null hypothesis."),
  answer("It is impossible to determine."),
  allow_retry = TRUE,
  random_answer_order = TRUE
  ),
  question_radio(
  "The result of the test means that",
  answer("The sample data did not provide significant evidence to suggest that the average age of men on Death Row is younger than the average age of women on Death Row."),
  answer("The sample data proved that the average age of men on Death Row is not younger than the average age of women on Death Row."),
  answer("The sample data provided significant evidence to suggest that the average age of men on Death Row is younger than the average age of women on Death Row", correct = TRUE),
  answer("The sample data provided significant evidence to suggest that the sample average age of men on Death Row is younger than the sample average age of women on Death Row."),
  allow_retry = TRUE,
  random_answer_order = TRUE
  )
)
```

## Problem 3

**Problem 3:** A recent random sample of 30 customers who switched to a car insurance company boasting that new customers save an average of \$534 per year resulted in an average savings of \$525 with a standard deviation of \$40. Find a 90% confidence interval for the true mean savings of customers switching to this company. (In case of emergency, [see worked solution here](www/SampleInferenceCarInsurance.pdf))

###

```{r prob3-1, echo = FALSE}
question_radio(
  "To answer the question as asked, we should",
  answer("Construct a confidence interval", correct = TRUE),
  answer("Conduct a hypothesis test"),
  answer("Compute a probability"),
  answer("Find a required sample size"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob3-2, echo = FALSE}
question_radio(
  "What is the desired level of confidence for this confidence interval?",
  answer("90%", correct = TRUE),
  answer("95%"),
  answer("98%"),
  answer("99%"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob3-3, echo = FALSE}
question_radio(
  "Is your confidence interval being build to capture a mean ($\\mu$), a proportion ($p$), or something else?",
  answer("A mean or difference in means", correct = TRUE),
  answer("A proportion or difference in proportions"),
  answer("Something else altogether"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob3-4, echo = FALSE}
question_radio(
  "Does the population parameter to be captured belong to a single group or is it a comparison of multiple groups?",
  answer("The population parameter belongs to a single group.", correct = TRUE),
  answer("The population parameter involves a comparison of two groups."),
  answer("The population parameter involves a comparison of more than two groups."),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

```{r prob3-5, echo = FALSE}
question_radio(
  "Do we know the population standard deviation ($\\sigma$) for dollars saved?",
  answer("Yes, the population standard deviation is known.", message = "Oops. We are presented with a standard deviation in savings but that standard deviation belongs only to the observations in the sample, not the entire population."),
  answer("No, the population standard deviation is not known.", correct = TRUE),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob3-6, echo = FALSE}
quiz(
  question_radio(
    "Which standard error formula should be used in the construction of the confidence interval?",
    answer("$\\displaystyle{S_E = \\sigma/\\sqrt{n}}$"),
    answer("$\\displaystyle{S_E = s/\\sqrt{n}}$", correct = TRUE),
    answer("$\\displaystyle{S_E = \\sigma_{\\text{diff}}/n_{\\text{diff}}}$"),
    answer("$\\displaystyle{S_E = s_{\\text{diff}}/\\sqrt{n_{\\text{diff}}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{\\sigma_1^2}{n_1} + \\frac{\\sigma_2^2}{n_2}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{s_1^2}{n_1} + \\frac{s_2^2}{n_2}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{p\\left(1 - p\\right)}{n}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{p_1\\left(1 - p_1\\right)}{n_1} + \\frac{p_2\\left(1 - p_2\\right)}{n_2}}}$"),
    allow_retry = TRUE,
    random_answer_order = TRUE
  ),
  question_radio(
    "Which distribution should be used to identify the critical value?",
    answer("The normal distribution"),
    answer("The $t$-distribution with $n - 1$ degrees of freedom.", correct = TRUE),
    answer("The $t$-distribution with $n_1 + n_2 - 2$ degrees of freedom."),
    answer("The $t$-distribution with $n_{\\text{diff}} - 1$ degrees of freedom."),
    allow_retry = TRUE,
    random_answer_order = TRUE
  )
)
```

###

Use the code block below to input or compute the critical value which should be used in the construction of the confidence interval.
```{r prob3-7, exercise = TRUE}

```

```{r prob3-7-check}
grade_result(
  pass_if(~ (abs(abs(.result) - qt(0.95, df = 30 - 1)) < 0.005))
)
```

###

Use the code block below to input or compute the point estimate.
```{r prob3-8, exercise = TRUE}

```

```{r prob3-8-check}
grade_result(
  pass_if(~ (.result == 525))
)
```

###

Use the code block below to input or compute the standard error.
```{r prob3-9, exercise = TRUE}

```

```{r prob3-9-check}
grade_result(
  pass_if(~ (abs(.result - (40/sqrt(30))) < 0.01))
)
```

###

Use the code block below to compute the lower bound for our confidence interval.
```{r prob3-10, exercise = TRUE}

```

```{r prob3-10-check}
grade_result(
  pass_if(~ (abs(.result - (525 - (qt(0.95, df = 30 - 1)*40/sqrt(30)))) < 0.01))
)
```

###

Use the code block below to compute the upper bound for our confidence interval.
```{r prob3-11, exercise = TRUE}

```

```{r prob3-11-check}
grade_result(
  pass_if(~ (abs(.result - (525 + (qt(0.95, df = 30 - 1)*40/sqrt(30)))) < 0.01))
)
```

###

```{r prob3-12, echo = FALSE}
question_radio(
  "The interpretations of the values you identified are:",
  answer("We are 90% confident that the true average savings customers should expect when switching to this provider is between the lower bound and upper bounds calculated.", correct = TRUE),
  answer("90% of the savings amounts customers realize when switching to this provider will fall between the lower and upper bounds calculated."),
  answer("We are 90% confident that the average savings customers in this sample experienced when switching to this provider fall between the lower and upper bounds calculated"),
  answer("There is a 90% chance a customer switching to this provider will realize a savings between the lower and upper bounds calculated."),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

## Problem 4

**Problem 4:** In January 2011, The Marist Poll published a report stating that 66% of adults nationally think licensed drivers should be required to retake their road test once they reach 65 years of age. In that same year, 200 random citizens of New Hampshire were asked whether they were in favor of an additional road test for drivers at 65 years of age, 118 responded that they were in favor. Construct a 95% confidence interval for the true proportion of New Hampshirites who are in favor of this proposal. (In case of emergency, [see worked solution here](www/SampleInferenceMaristPoll.pdf) -- you're on your own from here on out though!)

###

```{r prob4-1, echo = FALSE}
question_radio(
  "To answer the question as asked, we should",
  answer("Construct a confidence interval", correct = TRUE),
  answer("Conduct a hypothesis test"),
  answer("Compute a probability"),
  answer("Find a required sample size"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob4-2, echo = FALSE}
question_radio(
  "What is the desired level of confidence for this confidence interval?",
  answer("90%"),
  answer("95%", correct = TRUE),
  answer("98%"),
  answer("99%"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob4-3, echo = FALSE}
question_radio(
  "Is your confidence interval being build to capture a mean ($\\mu$), a proportion ($p$), or something else?",
  answer("A mean or difference in means"),
  answer("A proportion or difference in proportions", correct = TRUE),
  answer("Something else altogether"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob4-4, echo = FALSE}
question_radio(
  "Does the population parameter to be captured belong to a single group or is it a comparison of multiple groups?",
  answer("The population parameter belongs to a single group.", correct = TRUE),
  answer("The population parameter involves a comparison of two groups."),
  answer("The population parameter involves a comparison of more than two groups."),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

```{r prob4-5, echo = FALSE}
quiz(
  question_radio(
    "Which standard error formula should be used in the construction of the confidence interval?",
    answer("$\\displaystyle{S_E = \\sigma/\\sqrt{n}}$"),
    answer("$\\displaystyle{S_E = s/\\sqrt{n}}$"),
    answer("$\\displaystyle{S_E = \\sigma_{\\text{diff}}/n_{\\text{diff}}}$"),
    answer("$\\displaystyle{S_E = s_{\\text{diff}}/\\sqrt{n_{\\text{diff}}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{\\sigma_1^2}{n_1} + \\frac{\\sigma_2^2}{n_2}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{s_1^2}{n_1} + \\frac{s_2^2}{n_2}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{p\\left(1 - p\\right)}{n}}}$", correct = TRUE),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{p_1\\left(1 - p_1\\right)}{n_1} + \\frac{p_2\\left(1 - p_2\\right)}{n_2}}}$"),
    allow_retry = TRUE,
    random_answer_order = TRUE
  ),
  question_radio(
    "Which distribution should be used to identify the critical value?",
    answer("The normal distribution", correct = TRUE),
    answer("The $t$-distribution with $n - 1$ degrees of freedom."),
    answer("The $t$-distribution with $n_1 + n_2 - 2$ degrees of freedom."),
    answer("The $t$-distribution with $n_{\\text{diff}} - 1$ degrees of freedom."),
    allow_retry = TRUE,
    random_answer_order = TRUE
  )
)
```

###

Use the code block below to input or compute the critical value which should be used in the construction of the confidence interval.
```{r prob4-6, exercise = TRUE}

```

```{r prob4-6-check}
grade_result(
  pass_if(~ (abs(abs(.result) - qnorm(0.975)) < 0.005))
)
```

###

Use the code block below to input or compute the point estimate.
```{r prob4-7, exercise = TRUE}

```

```{r prob4-7-check}
grade_result(
  pass_if(~ abs(.result - (118/200)) < 0.0005)
)
```

###

Use the code block below to input or compute the standard error.
```{r prob4-8, exercise = TRUE}

```

```{r prob4-8-check}
grade_result(
  pass_if(~ (abs(.result - (sqrt(((118/200)*(1 - (118/200)))/200))) < 0.0005))
)
```

###

Use the code block below to compute the lower bound for our confidence interval.
```{r prob4-9, exercise = TRUE}

```

```{r prob4-9-check}
grade_result(
  pass_if(~ (abs(.result - ((118/200) - (qnorm(0.975)*sqrt(((118/200)*(1 - (118/200)))/200)))) < 0.0005))
)
```

###

Use the code block below to compute the upper bound for our confidence interval.
```{r prob4-10, exercise = TRUE}

```

```{r prob4-10-check}
grade_result(
  pass_if(~ (abs(.result - ((118/200) + (qnorm(0.975)*sqrt(((118/200)*(1 - (118/200)))/200)))) < 0.0005))
)
```

###

```{r prob4-11, echo = FALSE}
question_radio(
  "The interpretations of the values you identified are:",
  answer("We are 95% confident that the true proportion of New Hampshirites favoring the policy is between the lower bound and upper bounds calculated.", correct = TRUE),
  answer("95% of New Hampshirites favor the policy."),
  answer("We are 95% confident that the sample proportion of New Hampshirites favoring the policy fall between the lower and upper bounds calculated"),
  answer("There is a 95% chance true proportion of New Hampshirites favoring the policy falls between the lower and upper bounds calculated."),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

## Problem 5

**Problem5:** A pollster working for Pete Buttigieg is interested in identifying the proportion of registered democrats planning to vote in the NH primary for whom Mayor Pete is their first OR second choice candidate. If the pollster wants to estimate this proportion to within one percentage-point and at 95% confidence, how many voters should the pollster include in a sample if data from a focus group suggests that the proportion is near 42%?

###

```{r prob5-1, echo = FALSE}
question_radio(
  "To answer the question as asked, we should",
  answer("Construct a confidence interval"),
  answer("Conduct a hypothesis test"),
  answer("Compute a probability"),
  answer("Find a required sample size", correct = TRUE),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob5-2, echo = FALSE}
question_radio(
  "The parameter the pollster is attempting to measure is a...",
  answer("population mean"),
  answer("population proportion", correct = TRUE),
  answer("sample mean"),
  answer("sample proportion"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

Use the code block below to either input or compute the desired margin of error.
```{r prob5-3, exercise = TRUE}

```

```{r prob5-3-check}
grade_result(
  pass_if(~ (.result == 0.01))
)
```

###

Use the code block below to either input or critical value ($z_{\alpha/2}$) which should be used to compute the required sample size.
```{r prob5-4, exercise = TRUE}

```

```{r prob5-4-check}
grade_result(
  pass_if(~ (abs(.result - qnorm(0.975)) < 0.01))
)
```

###

Use the code block below to either input or compute the value of $p$ which should be used in the calculation of required sample size.
```{r prob5-5, exercise = TRUE}

```

```{r prob5-5-check}
grade_result(
  pass_if(~ (.result == 0.42))
)
```

###

Use the code block below to compute the minimum size sample the pollster could take and be within his parameters.
```{r prob5-6, exercise = TRUE}

```

```{r prob5-6-check}
grade_result(
  pass_if(~ ((abs(.result - (ceiling((qnorm(0.975)/0.01)^2*0.42*(1 - 0.42)))) < 10) & (.result - ceiling(.result) == 0)))
  #pass_if(~ (.result == ceiling((qnorm(0.975)/0.01)^2*0.42*(1 - 0.42))))
)
```

###

In the last problem, did you remember to round your answer up? Rounding the required sample size down results in either a loss of confidence or an increased margin of error, violating the requirements for the estimate.

## Problem 6

**Problem 6:** Greece has faced a severe economic crisis since the end of 2009. A Gallup poll surveyed 1,000 randomly sampled Greeks in 2011 and found that 25% of them said they would rate their lives poorly enough to be considered suffering. Construct a 95% confidence interval for the true proportion of Greeks who are suffering.

###

```{r prob6-1, echo = FALSE}
question_radio(
  "To answer the question as asked, we should",
  answer("Construct a confidence interval", correct = TRUE),
  answer("Conduct a hypothesis test"),
  answer("Compute a probability"),
  answer("Find a required sample size"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob6-2, echo = FALSE}
question_radio(
  "What is the desired level of confidence for this confidence interval?",
  answer("90%"),
  answer("95%", correct = TRUE),
  answer("98%"),
  answer("99%"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob6-3, echo = FALSE}
question_radio(
  "Is your confidence interval being build to capture a mean ($\\mu$), a proportion ($p$), or something else?",
  answer("A mean or difference in means"),
  answer("A proportion or difference in proportions", correct = TRUE),
  answer("Something else altogether"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob6-4, echo = FALSE}
question_radio(
  "Does the population parameter to be captured belong to a single group or is it a comparison of multiple groups?",
  answer("The population parameter belongs to a single group.", correct = TRUE),
  answer("The population parameter involves a comparison of two groups."),
  answer("The population parameter involves a comparison of more than two groups."),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

```{r prob6-5, echo = FALSE}
quiz(
  question_radio(
    "Which standard error formula should be used in the construction of the confidence interval?",
    answer("$\\displaystyle{S_E = \\sigma/\\sqrt{n}}$"),
    answer("$\\displaystyle{S_E = s/\\sqrt{n}}$"),
    answer("$\\displaystyle{S_E = \\sigma_{\\text{diff}}/n_{\\text{diff}}}$"),
    answer("$\\displaystyle{S_E = s_{\\text{diff}}/\\sqrt{n_{\\text{diff}}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{\\sigma_1^2}{n_1} + \\frac{\\sigma_2^2}{n_2}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{s_1^2}{n_1} + \\frac{s_2^2}{n_2}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{p\\left(1 - p\\right)}{n}}}$", correct = TRUE),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{p_1\\left(1 - p_1\\right)}{n_1} + \\frac{p_2\\left(1 - p_2\\right)}{n_2}}}$"),
    allow_retry = TRUE,
    random_answer_order = TRUE
  ),
  question_radio(
    "Which distribution should be used to identify the critical value?",
    answer("The normal distribution", correct = TRUE),
    answer("The $t$-distribution with $n - 1$ degrees of freedom."),
    answer("The $t$-distribution with $n_1 + n_2 - 2$ degrees of freedom."),
    answer("The $t$-distribution with $n_{\\text{diff}} - 1$ degrees of freedom."),
    allow_retry = TRUE,
    random_answer_order = TRUE
  )
)
```

###

Use the code block below to input or compute the critical value which should be used in the construction of the confidence interval.
```{r prob6-6, exercise = TRUE}

```

```{r prob6-6-check}
grade_result(
  pass_if(~ (abs(abs(.result) - qnorm(0.975)) < 0.01))
)
```

###

Use the code block below to input or compute the point estimate.
```{r prob6-7, exercise = TRUE}

```

```{r prob6-7-check}
grade_result(
  pass_if(~ (.result == 0.25))
)
```

###

Use the code block below to input or compute the standard error.
```{r prob6-8, exercise = TRUE}

```

```{r prob6-8-check}
grade_result(
  pass_if(~ (abs(.result - (sqrt(((0.25)*(1 - 0.25))/1000))) < 0.0005))
)
```

###

Use the code block below to compute the lower bound for our confidence interval.
```{r prob6-9, exercise = TRUE}

```

```{r prob6-9-check}
grade_result(
  pass_if(~ (abs(.result - (0.25 - (qnorm(0.975)*sqrt((0.25*(1 - 0.25))/1000)))) < 0.0005))
)
```

###

Use the code block below to compute the upper bound for our confidence interval.
```{r prob6-10, exercise = TRUE}

```

```{r prob6-10-check}
grade_result(
  pass_if(~ (abs(.result - (0.25 + (qnorm(0.975)*sqrt((0.25*(1 - 0.25))/1000)))) < 0.0005))
)
```

###

```{r prob6-11, echo = FALSE}
question_radio(
  "The interpretations of the values you identified are:",
  answer("We are 95% confident that the true proportion of Greeks who would describe their quality of life poor enough to be considered 'suffering' is between the lower bound and upper bounds calculated.", correct = TRUE),
  answer("95% of proportion of Greeks would describe their quality of life poor enough to be considered 'suffering'."),
  answer("We are 95% confident that the sample proportion of Greeks who would describe their quality of life poor enough to be considered 'suffering' fall between the lower and upper bounds calculated"),
  answer("There is a 95% chance true proportion of Greeks who would describe their quality of life poor enough to be considered 'suffering' falls between the lower and upper bounds calculated."),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

## Problem 7

**Problem 7:** A "social experiment" conducted by a TV program questioned what people do when they see a very angry father upset with his child about their poor athletic performance. On two different occasions at the same restaurant, a father and child were depicted. In one scenario the man was upset with a son and in the other scenario the he was angry with a daughter. The table below shows how many restaurant diners were present under each scenario, and whether or not they intervened.

<center>$\begin{array}{|c|c|c|c|} \hline \text{Scenario} & \text{Son} & \text{Daughter} & \text{Total} \\ \hline
\text{Intervened} & 15 & 25 & 40 \\ \hline
\text{No Action} & 25 & 20 & 45\\ \hline
\text{Total} & 40 & 45 & 85\\ \hline\end{array}$
</center>

Conduct a hypothesis test to determine whether there is evidence to suggest that the proportion of individuals willing to intervene in a "bad-parenting" scenario is dependent on the gender of the child?

###

```{r prob7-1, echo = FALSE}
question_radio(
  "To answer the question as asked, we should",
  answer("Construct a confidence interval"),
  answer("Conduct a hypothesis test", correct = TRUE),
  answer("Compute a probability"),
  answer("Find a required sample size"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob7-2, echo = FALSE}
question_radio(
  "What is the level of significance associated with this test?",
  answer("$\\alpha = 0.01$"),
  answer("$\\alpha = 0.10$"),
  answer("$\\alpha = 0.05$", correct = TRUE),
  answer("The $p$-value"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob7-3, echo = FALSE}
question_radio(
  "Does this hypothesis test involve testing a statement about the mean ($\\mu$), a proportion ($p$), or something else?",
  answer("One or more means"),
  answer("One or more proportions", correct = TRUE),
  answer("Something else altogether"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob7-4, echo = FALSE}
question_radio(
  "How many groups are being compared in this test?",
  answer("The test involves only a single group"),
  answer("The test compares two groups", correct = TRUE),
  answer("The test compares more than two groups"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob7-5, echo = FALSE}
question_radio(
  "Which of the following are the hypotheses associated with this test?",
  answer("$\\begin{array}{ll} H_0: & p_{\\text{son}} - p_{\\text{daughter}} = 0\\\\ H_a: & p_{\\text{son}} - p_{\\text{daughter}} \\neq 0\\end{array}$", correct = TRUE),
  answer("$\\begin{array}{ll} H_0: & p_{\\text{white}} - p_{\\text{non-white}} = 0\\\\ H_a: & p_{\\text{son}} - p_{\\text{daughter}} > 0\\end{array}$"),
  answer("$\\begin{array}{ll} H_0: & p_{\\text{son}} - p_{\\text{daughter}} = 0\\\\ H_a: & p_{\\text{son}} - p_{\\text{daughter}} < 0\\end{array}$"),
  answer("$\\begin{array}{ll} H_0: & p_{\\text{son}} \\neq p_{\\text{daughter}}\\\\ H_a: & p_{\\text{son}} = p_{\\text{daughter}}\\end{array}$"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob7-6, echo = FALSE}
quiz(
  question_radio(
    "Which standard error formula should be used in the computation of the test statistic?",
    answer("$\\displaystyle{S_E = \\sigma/\\sqrt{n}}$"),
    answer("$\\displaystyle{S_E = s/\\sqrt{n}}$"),
    answer("$\\displaystyle{S_E = \\sigma_{\\text{diff}}/n_{\\text{diff}}}$"),
    answer("$\\displaystyle{S_E = s_{\\text{diff}}/\\sqrt{n_{\\text{diff}}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{\\sigma_1^2}{n_1} + \\frac{\\sigma_2^2}{n_2}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{s_1^2}{n_1} + \\frac{s_2^2}{n_2}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{p\\left(1 - p\\right)}{n}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{p_1\\left(1 - p_1\\right)}{n_1} + \\frac{p_2\\left(1 - p_2\\right)}{n_2}}}$", correct = TRUE),
    allow_retry = TRUE,
    random_answer_order = TRUE
  ),
  question_radio(
    "Which distribution does the test statistic follow for this hypothesis test?",
    answer("The normal distribution", correct = TRUE),
    answer("The $t$-distribution with $n - 1$ degrees of freedom."),
    answer("The $t$-distribution with $n_1 + n_2 - 2$ degrees of freedom."),
    answer("The $t$-distribution with $n_{\\text{diff}} - 1$ degrees of freedom."),
    allow_retry = TRUE,
    random_answer_order = TRUE
  )
)
```

###

Now we'll begin building the test statistic. Use the code block below to input or compute the point estimate for our population parameter.
```{r prob7-7, exercise = TRUE}

```

```{r prob7-7-check}
grade_result(
  pass_if(~ (abs(abs(.result) - abs((15/40) - (25/45))) < 0.005))
)
```

###

Use the code block below to input or compute the null value.
```{r prob7-8, exercise = TRUE}

```

```{r prob7-8-check}
grade_result(
  pass_if(~ (.result == 0))
)
```

###

Use the code block below to input or compute the standard error.
```{r prob7-9, exercise = TRUE}

```

```{r prob7-9-check}
grade_result(
  pass_if(~ (abs(.result - sqrt(((15/40)*(1 - (15/40))/40) + ((25/45)*(1 - (25/45))/45))) < 0.0005))
)
```

###

Use the code block below to input or compute the test statistic.
```{r prob7-10, exercise = TRUE}

```

```{r prob7-10-check}
grade_result(
  pass_if(~ (abs(abs(.result) - (abs((((15/40) - (25/45)) - 0)/sqrt(((15/40)*(1 - (15/40))/40) + ((25/45)*(1 - (25/45))/45))))) < 0.01))
)
```

###

Use the code block below to compute the $p$-value associated with this test.
```{r prob7-11, exercise = TRUE}

```

```{r prob7-11-check}
grade_result(
  pass_if(~ (abs(.result - (2*(1 - pnorm(abs((((15/40) - (25/45)) - 0)/sqrt(((15/40)*(1 - (15/40))/40) + ((25/45)*(1 - (25/45))/45))))))) < 0.001))
)
```

###

Answer the following to complete the hypothesis test.

```{r prob7-12, echo = FALSE}
quiz(
  question_radio(
    "What is the result of the test?",
    answer("Since $p \\geq \\alpha$, we do not have enough evidence to reject the null hypothesis.", correct = TRUE),
  answer("Since $p \\geq \\alpha$, we accept the null hypothesis."),
  answer("Since $p < \\alpha$, we reject the null hypothesis and accept the alternative hypothesis."),
  answer("Since $p < \\alpha$, we fail to reject the null hypothesis."),
  answer("It is impossible to determine."),
  allow_retry = TRUE,
  random_answer_order = TRUE
  ),
  question_radio(
  "The result of the test means that",
  answer("The sample data did not provide significant evidence to suggest that there is a difference in the proportion of diners willing to intervene in a 'bad-parenting' scenario based on the gender of the child.", correct = TRUE),
  answer("The sample data proved that there is no difference in the proportion of diners willing to intervene in a 'bad-parenting' scenario based on the gender of the child."),
  answer("The sample data provided significant evidence to suggest a difference in the proportion of diners willing to intervene in a 'bad-parenting' scenario based on the gender of the child"),
  answer("The sample data provided significant evidence to suggest a difference in the sample proportion of diners willing to intervene in a 'bad-parenting' scenario based on the gender of the child."),
  allow_retry = TRUE,
  random_answer_order = TRUE
  )
)
```

## Problem 8

**Problem 8:** A University has a policy that its sports teams require no more than 15 hours per week of time commitment from players during off-season. A random survey of 12 players from the University's Quidditch team during the Fall Semester (Quidditch is a Spring Sport) resulted in a mean on 15.25 hours per week of Quidditch-related activity on average, with a standard deviation of 1 hour. Is there evidence to suggest that the University Quidditch Coach is not following University Policy? Use $\alpha = 0.10$.

###

```{r prob8-1, echo = FALSE}
question_radio(
  "To answer the question as asked, we should",
  answer("Construct a confidence interval"),
  answer("Conduct a hypothesis test", correct = TRUE),
  answer("Compute a probability"),
  answer("Find a required sample size"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob8-2, echo = FALSE}
question_radio(
  "What is the level of significance associated with this test?",
  answer("$\\alpha = 0.01$"),
  answer("$\\alpha = 0.10$", correct = TRUE),
  answer("$\\alpha = 0.05$"),
  answer("The $p$-value"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob8-3, echo = FALSE}
question_radio(
  "Does this hypothesis test involve testing a statement about the mean ($\\mu$), a proportion ($p$), or something else?",
  answer("One or more means", correct = TRUE),
  answer("One or more proportions"),
  answer("Something else altogether"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob8-4, echo = FALSE}
question_radio(
  "How many groups are being compared in this test?",
  answer("The test involves only a single group", correct = TRUE),
  answer("The test compares two groups"),
  answer("The test compares more than two groups"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob8-5, echo = FALSE}
question_radio(
  "Which of the following are the hypotheses associated with this test?",
  answer("$\\begin{array}{ll} H_0: & \\mu = 15\\\\ H_a: & \\mu > 15\\end{array}$", correct = TRUE),
  answer("$\\begin{array}{ll} H_0: & \\mu = 15\\\\ H_a: & \\mu \\neq 15\\end{array}$"),
  answer("$\\begin{array}{ll} H_0: & \\mu = 15\\\\ H_a: & \\mu < 15\\end{array}$"),
  answer("$\\begin{array}{ll} H_0: & \\mu = 15.25\\\\ H_a: & \\mu < 15.25\\end{array}$"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob8-6, echo = FALSE}
question_radio(
  "Do we know the population standard deviation(s), $\\sigma$, for hours spent on Quiddich?",
  answer("Yes, the population standard deviations are known.", message = "Oops. We are presented with a standard deviation in hours spent but that belongs to only those players included in the sample, not the entire population."),
  answer("No, the population standard deviation is not known.", correct = TRUE),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob8-7, echo = FALSE}
quiz(
  question_radio(
    "Which standard error formula should be used in the computation of the test statistic?",
    answer("$\\displaystyle{S_E = \\sigma/\\sqrt{n}}$"),
    answer("$\\displaystyle{S_E = s/\\sqrt{n}}$", correct = TRUE),
    answer("$\\displaystyle{S_E = \\sigma_{\\text{diff}}/n_{\\text{diff}}}$"),
    answer("$\\displaystyle{S_E = s_{\\text{diff}}/\\sqrt{n_{\\text{diff}}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{\\sigma_1^2}{n_1} + \\frac{\\sigma_2^2}{n_2}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{s_1^2}{n_1} + \\frac{s_2^2}{n_2}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{p\\left(1 - p\\right)}{n}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{p_1\\left(1 - p_1\\right)}{n_1} + \\frac{p_2\\left(1 - p_2\\right)}{n_2}}}$"),
    allow_retry = TRUE,
    random_answer_order = TRUE
  ),
  question_radio(
    "Which distribution does the test statistic follow for this hypothesis test?",
    answer("The normal distribution"),
    answer("The $t$-distribution with $n - 1$ degrees of freedom.", correct = TRUE),
    answer("The $t$-distribution with $n_1 + n_2 - 2$ degrees of freedom."),
    answer("The $t$-distribution with $n_{\\text{diff}} - 1$ degrees of freedom."),
    allow_retry = TRUE,
    random_answer_order = TRUE
  )
)
```

###

Now we'll begin building the test statistic. Use the code block below to input or compute the point estimate for our population parameter.
```{r prob8-8, exercise = TRUE}

```

```{r prob8-8-check}
grade_result(
  pass_if(~ (abs(.result) == 15.25))
)
```

###

Use the code block below to input or compute the null value.
```{r prob8-9, exercise = TRUE}

```

```{r prob8-9-check}
grade_result(
  pass_if(~ (.result == 15))
)
```

###

Use the code block below to input or compute the standard error.
```{r prob8-10, exercise = TRUE}

```

```{r prob8-10-check}
grade_result(
  pass_if(~ (abs(.result - (1/sqrt(12))) < 0.01))
)
```

###

Use the code block below to input or compute the test statistic.
```{r prob8-11, exercise = TRUE}

```

```{r prob8-11-check}
grade_result(
  pass_if(~ (abs(.result - ((15.25 - 15)/(1/sqrt(12)))) < 0.01))
)
```

###

Use the code block below to compute the $p$-value associated with this test.
```{r prob8-12, exercise = TRUE}

```

```{r prob8-12-check}
grade_result(
  pass_if(~ (abs(.result - (1 - pt((15.25 - 15)/(1/sqrt(12)), df = 12 - 1))) < 0.0005))
)
```

###

Answer the following to complete the hypothesis test.

```{r prob8-13, echo = FALSE}
quiz(
  question_radio(
    "What is the result of the test?",
    answer("Since $p \\geq \\alpha$, we do not have enough evidence to reject the null hypothesis.", correct = TRUE),
  answer("Since $p \\geq \\alpha$, we accept the null hypothesis."),
  answer("Since $p < \\alpha$, we reject the null hypothesis and accept the alternative hypothesis."),
  answer("Since $p < \\alpha$, we fail to reject the null hypothesis."),
  answer("It is impossible to determine."),
  allow_retry = TRUE,
  random_answer_order = TRUE
  ),
  question_radio(
  "The result of the test means that",
  answer("The sample data did not provide significant evidence to suggest that the University Quiddich coach is violating the off-season time committment policy.", correct = TRUE),
  answer("The sample data proved that the University Quiddich coach is not violating the off-season time committment policy."),
  answer("The sample data provided significant evidence to suggest that the University Quiddich coach is violating the off-season time committment policy"),
  answer("The sample data proved that the University Quiddich coach is violating the off-season time committment policy."),
  allow_retry = TRUE,
  random_answer_order = TRUE
  )
)
```

## Problem 9

**Problem 9:** A market researcher wants to evaluate car insurance savings at a competing company. Based on past studies he is assuming that the standard deviation of savings is \$100. He wants to collect data such that he can get a margin of error of no more than \$10 at a 95% confidence level. How large of a sample should he collect?

###

```{r prob9-1, echo = FALSE}
question_radio(
  "To answer the question as asked, we should",
  answer("Construct a confidence interval"),
  answer("Conduct a hypothesis test"),
  answer("Compute a probability"),
  answer("Find a required sample size", correct = TRUE),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob9-2, echo = FALSE}
question_radio(
  "The parameter the market researcher is attempting to measure is a...",
  answer("population mean", correct = TRUE),
  answer("population proportion"),
  answer("sample mean"),
  answer("sample proportion"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

Use the code block below to either input or compute the desired margin of error (don't include the \$ sign in your answer).
```{r prob9-3, exercise = TRUE}

```

```{r prob9-3-check}
grade_result(
  pass_if(~ (.result == 10))
)
```

###

Use the code block below to either input or critical value ($z_{\alpha/2}$) which should be used to compute the required sample size.
```{r prob9-4, exercise = TRUE}

```

```{r prob9-4-check}
grade_result(
  pass_if(~ (abs(.result - qnorm(0.975)) < 0.01))
)
```

###

Use the code block below to either input or compute the estimate for $\sigma$ which should be used in the calculation of required sample size (don't include the \$ sign in your response).
```{r prob9-5, exercise = TRUE}

```

```{r prob9-5-check}
grade_result(
  pass_if(~ (.result == 100))
)
```

###

Use the code block below to compute the minimum size sample the pollster could take and be within his parameters.
```{r prob9-6, exercise = TRUE}

```

```{r prob9-6-check}
grade_result(
  pass_if(~ ((abs(.result - (ceiling((qnorm(0.975)*100/10)^2))) < 10) & (.result - ceiling(.result) == 0)))
)
```

## Problem 10

**Problem 10:** A Washington Post article from 2009 reported that "support for a government-run health-care plan to compete with private insurers has rebounded from its summertime lows and wins clear majority support from the public." More specifically, the article says "seven in 10 Democrats back the plan, while almost nine in 10 Republicans oppose it. Independents divide 52 percent against, 42 percent in favor of the legislation." (6% responded with "other".) There were 819 Democrats, 566 Republicans and 783 Independents surveyed. A political pundit on TV claims that a majority of Independents oppose the health care public option plan. Do these data provide significant evidence to support this statement?

###

```{r prob10-1, echo = FALSE}
question_radio(
  "To answer the question as asked, we should",
  answer("Construct a confidence interval"),
  answer("Conduct a hypothesis test", correct = TRUE),
  answer("Compute a probability"),
  answer("Find a required sample size"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob10-2, echo = FALSE}
question_radio(
  "What is the level of significance associated with this test?",
  answer("$\\alpha = 0.01$"),
  answer("$\\alpha = 0.10$"),
  answer("$\\alpha = 0.05$", correct = TRUE),
  answer("The $p$-value"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob10-3, echo = FALSE}
question_radio(
  "Does this hypothesis test involve testing a statement about the mean ($\\mu$), a proportion ($p$), or something else?",
  answer("One or more means"),
  answer("One or more proportions", correct = TRUE),
  answer("Something else altogether"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob10-4, echo = FALSE}
question_radio(
  "How many groups are being compared in this test?",
  answer("The test involves only a single group", correct = TRUE),
  answer("The test compares two groups", message = "Oops. The article provides information about democrats, republicans, and independents but the test only considers the independents."),
  answer("The test compares more than two groups", message = "Oops. The article provides information about democrats, republicans, and independents but the test only considers the independents."),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob10-5, echo = FALSE}
question_radio(
  "Which of the following are the hypotheses associated with this test?",
  answer("$\\begin{array}{ll} H_0: & p = 0.5\\\\ H_a: & p > 0.5\\end{array}$", correct = TRUE),
  answer("$\\begin{array}{ll} H_0: & p = 0.52\\\\ H_a: & p > 0.52\\end{array}$"),
  answer("$\\begin{array}{ll} H_0: & p = 0.5\\\\ H_a: & p \\neq 0.5\\end{array}$"),
  answer("$\\begin{array}{ll} H_0: & p = 0.52\\\\ H_a: & p \\neq 0.52\\end{array}$"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob10-6, echo = FALSE}
quiz(
  question_radio(
    "Which standard error formula should be used in the computation of the test statistic?",
    answer("$\\displaystyle{S_E = \\sigma/\\sqrt{n}}$"),
    answer("$\\displaystyle{S_E = s/\\sqrt{n}}$"),
    answer("$\\displaystyle{S_E = \\sigma_{\\text{diff}}/n_{\\text{diff}}}$"),
    answer("$\\displaystyle{S_E = s_{\\text{diff}}/\\sqrt{n_{\\text{diff}}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{\\sigma_1^2}{n_1} + \\frac{\\sigma_2^2}{n_2}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{s_1^2}{n_1} + \\frac{s_2^2}{n_2}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{p\\left(1 - p\\right)}{n}}}$", correct = TRUE),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{p_1\\left(1 - p_1\\right)}{n_1} + \\frac{p_2\\left(1 - p_2\\right)}{n_2}}}$"),
    allow_retry = TRUE,
    random_answer_order = TRUE
  ),
  question_radio(
    "Which distribution does the test statistic follow for this hypothesis test?",
    answer("The normal distribution", correct = TRUE),
    answer("The $t$-distribution with $n - 1$ degrees of freedom."),
    answer("The $t$-distribution with $n_1 + n_2 - 2$ degrees of freedom."),
    answer("The $t$-distribution with $n_{\\text{diff}} - 1$ degrees of freedom."),
    allow_retry = TRUE,
    random_answer_order = TRUE
  )
)
```

###

Now we'll begin building the test statistic. Use the code block below to input or compute the point estimate for our population parameter.
```{r prob10-7, exercise = TRUE}

```

```{r prob10-7-check}
grade_result(
  pass_if(~ (abs(.result) == 0.52))
)
```

###

Use the code block below to input or compute the null value.
```{r prob10-8, exercise = TRUE}

```

```{r prob10-8-check}
grade_result(
  pass_if(~ (.result == 0.5))
)
```

###

Use the code block below to input or compute the standard error.
```{r prob10-9, exercise = TRUE}

```

```{r prob10-9-check}
grade_result(
  pass_if(~ (abs(.result - (sqrt(0.5*(1 - 0.5)/783))) < 0.0005))
)
```

###

Use the code block below to input or compute the test statistic.
```{r prob10-10, exercise = TRUE}

```

```{r prob10-10-check}
grade_result(
  pass_if(~ (abs(.result - ((0.52 - 0.5)/(sqrt(0.5*(1 - 0.5)/783)))) < 0.01))
)
```

###

Use the code block below to compute the $p$-value associated with this test.
```{r prob10-11, exercise = TRUE}

```

```{r prob10-11-check}
grade_result(
  pass_if(~ (abs(.result - (1 - pnorm((0.52 - 0.5)/(sqrt(0.5*(1 - 0.5)/783))))) < 0.0005))
)
```

###

Answer the following to complete the hypothesis test.

```{r prob10-12, echo = FALSE}
quiz(
  question_radio(
    "What is the result of the test?",
    answer("Since $p \\geq \\alpha$, we do not have enough evidence to reject the null hypothesis.", correct = TRUE),
  answer("Since $p \\geq \\alpha$, we accept the null hypothesis."),
  answer("Since $p < \\alpha$, we reject the null hypothesis and accept the alternative hypothesis."),
  answer("Since $p < \\alpha$, we fail to reject the null hypothesis."),
  answer("It is impossible to determine."),
  allow_retry = TRUE,
  random_answer_order = TRUE
  ),
  question_radio(
  "The result of the test means that",
  answer("The sample data did not provide significant evidence to suggest that a majority of independents oppose the health care public option.", correct = TRUE),
  answer("The sample data proved that a majority of independents oppose the health care public option."),
  answer("The sample data provided significant evidence to suggest that a majority of independents oppose the health care public option."),
  answer("The sample data proved that a majority of independents do not oppose the health care public option."),
  allow_retry = TRUE,
  random_answer_order = TRUE
  )
)
```

## Problem 11

**Problem 11:** Is there strong evidence of global warming? Let's consider a small scale example, comparing how temperatures have changed in the US from 1968 to 2008. The daily high temperature reading on January 1 was collected in 1968 and 2008 for 51 randomly selected locations in the continental US. Then the difference between the two readings (temperature in 2008 - temperature in 1968) was calculated for each of the 51 different locations. The average of these 51 values was 1.1 degrees with a standard deviation of 4.9 degrees. We are interested in determining whether these data provide strong evidence of temperature warming in the continental US. Conduct a hypothesis test to determine whether there is strong evidence for an increase in average temperature between 1968 and 2008.

###

```{r prob11-1, echo = FALSE}
question_radio(
  "To answer the question as asked, we should",
  answer("Construct a confidence interval"),
  answer("Conduct a hypothesis test", correct = TRUE),
  answer("Compute a probability"),
  answer("Find a required sample size"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob11-2, echo = FALSE}
question_radio(
  "What is the level of significance associated with this test?",
  answer("$\\alpha = 0.01$"),
  answer("$\\alpha = 0.10$"),
  answer("$\\alpha = 0.05$", correct = TRUE),
  answer("The $p$-value"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob11-3, echo = FALSE}
question_radio(
  "Does this hypothesis test involve testing a statement about the mean ($\\mu$), a proportion ($p$), or something else?",
  answer("One or more means", correct = TRUE),
  answer("One or more proportions"),
  answer("Something else altogether"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob11-4, echo = FALSE}
question_radio(
  "How many groups are being compared in this test?",
  answer("The test involves only a single group", correct = TRUE, message = "Good work -- technically this is true because rather than looking at temperatures in 1968 and 2008 independently of one another, we are actually looking at the differences in temperature in each individual location. That is, once we compute the differences in temperature, we have a single observation for each location."),
  answer("The test compares two groups", correct = TRUE),
  answer("The test compares more than two groups"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob11-5, echo = FALSE}
question_radio(
  "Which of the following are the hypotheses associated with this test?",
  answer("$\\begin{array}{ll} H_0: & \\mu_{\\text{2008}} - \\mu_{\\text{1968}} = 0\\\\ H_a: & \\mu_{\\text{2008}} - \\mu_{\\text{1968}} \\neq 0\\end{array}$"),
  answer("$\\begin{array}{ll} H_0: & \\mu_{\\text{2008}} - \\mu_{\\text{1968}} = 0\\\\ H_a: & \\mu_{\\text{2008}} - \\mu_{\\text{1968}} > 0\\end{array}$", correct = TRUE),
  answer("$\\begin{array}{ll} H_0: & \\mu_{\\text{2008}} - \\mu_{\\text{1968}} = 0\\\\ H_a: & \\mu_{\\text{2008}} - \\mu_{\\text{1968}} < 0\\end{array}$"),
  answer("$\\begin{array}{ll} H_0: & \\mu_{\\text{2008}} \\neq \\mu_{\\text{1968}}\\\\ H_a: & \\mu_{\\text{2008}} = \\mu_{\\text{1968}}\\end{array}$"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob11-6, echo = FALSE}
question_radio(
  "Do we know the population standard deviation(s), $\\sigma$, for difference in temperature?",
  answer("Yes, the population standard deviations are known.", message = "Oops. We are presented with a standard deviation in temperature differences but that standard deviation belongs only to the sample temperatures measured, not the population."),
  answer("No, the population standard deviations are not known.", correct = TRUE),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob11-7, echo = FALSE}
question_radio(
  "Are the observations in the two groups (males on Death Row and females on Death Row) paired?",
  answer("No. There is no reason to suggest that the individual 1968 and 2008 temperature readings correspond to one another."),
  answer("Yes. Every temperature reading from 1968 can be naturally paired with the 2008 reading from the same location.", correct = TRUE),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob11-8, echo = FALSE}
quiz(
  question_radio(
    "Which standard error formula should be used in the computation of the test statistic?",
    answer("$\\displaystyle{S_E = \\sigma/\\sqrt{n}}$"),
    answer("$\\displaystyle{S_E = s/\\sqrt{n}}$"),
    answer("$\\displaystyle{S_E = \\sigma_{\\text{diff}}/n_{\\text{diff}}}$"),
    answer("$\\displaystyle{S_E = s_{\\text{diff}}/\\sqrt{n_{\\text{diff}}}}$", correct = TRUE),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{\\sigma_1^2}{n_1} + \\frac{\\sigma_2^2}{n_2}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{s_1^2}{n_1} + \\frac{s_2^2}{n_2}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{p\\left(1 - p\\right)}{n}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{p_1\\left(1 - p_1\\right)}{n_1} + \\frac{p_2\\left(1 - p_2\\right)}{n_2}}}$"),
    allow_retry = TRUE,
    random_answer_order = TRUE
  ),
  question_radio(
    "Which distribution does the test statistic follow for this hypothesis test?",
    answer("The normal distribution"),
    answer("The $t$-distribution with $n - 1$ degrees of freedom."),
    answer("The $t$-distribution with $n_1 + n_2 - 2$ degrees of freedom."),
    answer("The $t$-distribution with $n_{\\text{diff}} - 1$ degrees of freedom.", correct = TRUE),
    allow_retry = TRUE,
    random_answer_order = TRUE
  )
)
```

###

Now we'll begin building the test statistic. Use the code block below to input or compute the point estimate for our population parameter.
```{r prob11-9, exercise = TRUE}

```

```{r prob11-9-check}
grade_result(
  pass_if(~ (abs(.result) == 1.1))
)
```

###

Use the code block below to input or compute the null value.
```{r prob11-10, exercise = TRUE}

```

```{r prob11-10-check}
grade_result(
  pass_if(~ (.result == 0))
)
```

###

Use the code block below to input or compute the standard error.
```{r prob11-11, exercise = TRUE}

```

```{r prob11-11-check}
grade_result(
  pass_if(~ (abs(.result - (4.9/sqrt(51))) < 0.01))
)
```

###

Use the code block below to input or compute the test statistic.
```{r prob11-12, exercise = TRUE}

```

```{r prob11-12-check}
grade_result(
  pass_if(~ (abs(.result - ((1.1 - 0)/(4.9/sqrt(51)))) < 0.01))
)
```

###

Use the code block below to compute the $p$-value associated with this test.
```{r prob11-13, exercise = TRUE}

```

```{r prob11-13-check}
grade_result(
  pass_if(~ (abs(.result - (1 - pt(((1.1 - 0)/(4.9/sqrt(51))), df = 51 -1))) < 0.0005))
)
```

###

Answer the following to complete the hypothesis test.

```{r prob11-14, echo = FALSE}
quiz(
  question_radio(
    "What is the result of the test?",
    answer("Since $p \\geq \\alpha$, we do not have enough evidence to reject the null hypothesis.", correct = TRUE),
  answer("Since $p \\geq \\alpha$, we accept the null hypothesis."),
  answer("Since $p < \\alpha$, we reject the null hypothesis and accept the alternative hypothesis."),
  answer("Since $p < \\alpha$, we fail to reject the null hypothesis."),
  answer("It is impossible to determine."),
  allow_retry = TRUE,
  random_answer_order = TRUE
  ),
  question_radio(
  "The result of the test means that",
  answer("The sample data did not provide significant evidence to suggest that temperatures in the US have increased from January 1, 1968 to January 1, 2008.", correct = TRUE),
  answer("The sample data proved that temperatures in the US have increased from January 1, 1968 to January 1, 2008."),
  answer("The sample data provided significant evidence to suggest that temperatures in the US have increased from January 1, 1968 to January 1, 2008."),
  answer("The sample data provided significant evidence to suggest that temperatures in the US have increased from January 1, 1968 to January 1, 2008 within our sample data."),
  allow_retry = TRUE,
  random_answer_order = TRUE
  )
)
```

## Problem 12

**Problem 12:** A recent claim from Irving states that their average gasoline prices across the nation are \$2.10 per gallon. A random sample of 15 Irving stations throughout Manchester, NH reveals an average price per gallon of \$2.03 with a standard deviation of \$0.025. construct a 90% confidence interval for the average price per gallon of gas in Manchester, NH. Comment on your result.

###

```{r prob12-1, echo = FALSE}
question_radio(
  "To answer the question as asked, we should",
  answer("Construct a confidence interval", correct = TRUE),
  answer("Conduct a hypothesis test"),
  answer("Compute a probability"),
  answer("Find a required sample size"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob12-2, echo = FALSE}
question_radio(
  "What is the desired level of confidence for this confidence interval?",
  answer("90%", correct = TRUE),
  answer("95%"),
  answer("98%"),
  answer("99%"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob12-3, echo = FALSE}
question_radio(
  "Is your confidence interval being build to capture a mean ($\\mu$), a proportion ($p$), or something else?",
  answer("A mean or difference in means", correct = TRUE),
  answer("A proportion or difference in proportions"),
  answer("Something else altogether"),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob12-4, echo = FALSE}
question_radio(
  "Does the population parameter to be captured belong to a single group or is it a comparison of multiple groups?",
  answer("The population parameter belongs to a single group.", correct = TRUE),
  answer("The population parameter involves a comparison of two groups."),
  answer("The population parameter involves a comparison of more than two groups."),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

###

```{r prob12-5, echo = FALSE}
question_radio(
  "Is the population standard deviation, $\\sigma$, for gas prices known?",
  answer("Yes, the population standard deviation in gas prices is known."),
  answer("No, the population standard deviation in gas prices is not known.", correct = TRUE),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

```{r prob12-6, echo = FALSE}
quiz(
  question_radio(
    "Which standard error formula should be used in the construction of the confidence interval?",
    answer("$\\displaystyle{S_E = \\sigma/\\sqrt{n}}$"),
    answer("$\\displaystyle{S_E = s/\\sqrt{n}}$", correct = TRUE),
    answer("$\\displaystyle{S_E = \\sigma_{\\text{diff}}/n_{\\text{diff}}}$"),
    answer("$\\displaystyle{S_E = s_{\\text{diff}}/\\sqrt{n_{\\text{diff}}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{\\sigma_1^2}{n_1} + \\frac{\\sigma_2^2}{n_2}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{s_1^2}{n_1} + \\frac{s_2^2}{n_2}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{p\\left(1 - p\\right)}{n}}}$"),
    answer("$\\displaystyle{S_E = \\sqrt{\\frac{p_1\\left(1 - p_1\\right)}{n_1} + \\frac{p_2\\left(1 - p_2\\right)}{n_2}}}$"),
    allow_retry = TRUE,
    random_answer_order = TRUE
  ),
  question_radio(
    "Which distribution should be used to identify the critical value?",
    answer("The normal distribution"),
    answer("The $t$-distribution with $n - 1$ degrees of freedom.", correct = TRUE),
    answer("The $t$-distribution with $n_1 + n_2 - 2$ degrees of freedom."),
    answer("The $t$-distribution with $n_{\\text{diff}} - 1$ degrees of freedom."),
    allow_retry = TRUE,
    random_answer_order = TRUE
  )
)
```

###

Use the code block below to input or compute the critical value which should be used in the construction of the confidence interval.
```{r prob12-7, exercise = TRUE}

```

```{r prob12-7-check}
grade_result(
  pass_if(~ (abs(abs(.result) - qt(0.95, df = 15 - 1)) < 0.01))
)
```

###

Use the code block below to input or compute the point estimate.
```{r prob12-8, exercise = TRUE}

```

```{r prob12-8-check}
grade_result(
  pass_if(~ (.result == 2.03))
)
```

###

Use the code block below to input or compute the standard error.
```{r prob12-9, exercise = TRUE}

```

```{r prob12-9-check}
grade_result(
  pass_if(~ (abs(.result - (0.025/sqrt(15))) < 0.005))
)
```

###

Use the code block below to compute the lower bound for our confidence interval.
```{r prob12-10, exercise = TRUE}

```

```{r prob12-10-check}
grade_result(
  pass_if(~ (abs(.result - (2.03 - (qt(0.95, df = 15 - 1)*(0.025/sqrt(15))))) < 0.005))
)
```

###

Use the code block below to compute the upper bound for our confidence interval.
```{r prob12-11, exercise = TRUE}

```

```{r prob12-11-check}
grade_result(
  pass_if(~ (abs(.result - (2.03 + (qt(0.95, df = 15 - 1)*(0.025/sqrt(15))))) < 0.005))
)
```

###

```{r prob12-12, echo = FALSE}
question_radio(
  "The interpretations of the values you identified are:",
  answer("We are 90% confident that the true average gas price at Irving stations in Manchester, NH is between the lower bound and upper bounds calculated.", correct = TRUE),
  answer("90% of gas stations in Manchester, NH have gas prices between the lower and upper bounds computed."),
  answer("We are 90% confident that the average gas price at Irving stations in NH falls between the lower and upper bounds calculated", message = "Remember that results from a sample may only be generalized to a population for which that sample is representative."),
  answer("There is a 90% chance that the true average gas price at Irving stations in Manchester, NH falls between the lower and upper bounds calculated."),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```
