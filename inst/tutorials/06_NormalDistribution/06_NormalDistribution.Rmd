---
title: "Topic 6: The Normal Distribution"
tutorial:
  id: "NormalDist.Topic6.AppliedStats"
  version: 1.0
output: 
  learnr::tutorial:
    progressive: TRUE
    allow_skip: TRUE
    
runtime: shiny_prerendered
description: "An introduction to working with normally distributed data. This notebook covers the calculation of probabilities and percentiles. It also introduces the notion of the z-score."
---

```{r setup, include=FALSE}
#knitr::opts_chunk$set(eval = FALSE)
#library(tidyverse)
library(dplyr)
library(ggplot2)
library(learnr)
library(gradethis)


tutorial_options(exercise.timelimit = 60, exercise.checker = gradethis::grade_learnr)

#set.seed(round(as.numeric(Sys.time()), -2))
set.seed(241)

boundary1 <- round(runif(1, 0.75, 2), 2)
boundary2 <- round(runif(1, -2, -1.5), 2)
boundary3 <- round(runif(1, -2.5, -0.75), 2)
boundary4 <- round(runif(1, 0.75, 2.5), 2)
boundary5a <- round(runif(1, -1.5, -0.75), 2)
boundary5b <- round(runif(1, 1, 2.5), 2)
boundary6a <- round(runif(1, -1.5, -0.75), 2)
boundary6b <- round(runif(1, 1.5, 2.5), 2)
boundary7 <- round(runif(1, 1, 2.5), 2)

chickPoxSampSize <- sample(50:150, size = 1)
#knitr::opts_chunk$set(eval = FALSE)
```



## Topic 6: The Normal Distribution

###

Throughout this workbook we'll investigate the probability distribution that is most central to our study of statistics: the normal distribution.  If we are confident that our data are nearly normal, that opens the door to many powerful statistical methods. This workbook gives you practice with normally distributed data.

## Objectives

**Workbook Objectives:** After completing this workbook you should be able to:

+ Compute probabilities of events well-modeled by a normal distribution.
+ Given a variable $X$ which follows an assumed normal distribution, compute and interpret various percentile thresholds for $X$.
+ Identify scenarios to which the normal or binomial distributions can be applied, and use them to answer various probability-related questions.

###

## The Normal Distribution

**Definition:** If a random variable $X$ is normally distributed with mean $\mu$ and standard deviation $\sigma$, we often write $X\sim N\left(\mu, \sigma\right)$. Three different normal distributions appear below.

+ In **<span style = "color:blue">blue</span>** is a normal distribution with $\mu = 0$ and $\sigma = 5$
+ In **<span style = "color:red">red</span>** is a normal distribution with $\mu = 0$ and $\sigma = 0.5$
+ In **black** is a normal distribution with $\mu = 0$ and $\sigma = 1$ (the so-called *Standard Normal Distribution*)

```{r three-normals, echo = FALSE, eval = TRUE, message = FALSE, warning = FALSE, results = FALSE}
ggplot() + geom_line(mapping = aes(x = seq(-15, 15, length.out = 200), y = dnorm(seq(-15, 15, length.out = 200), 0, 5)), color = "blue", lwd = 1.25) + geom_line(mapping = aes(x = seq(-15, 15, length.out = 200), y = dnorm(seq(-15, 15, length.out = 200), 0, 0.5)), color = "red", lwd = 1.25) + geom_line(mapping = aes(x = seq(-15, 15, length.out = 200), y = dnorm(seq(-15, 15, length.out = 200), 0, 1)), color = "black", lwd = 1.25) + labs(title = "Three Normal Distributions", x = "", y= "")
```

###

Notice that all three distributions are bell-shaped and are centered at their mean ($\mu = 0$). The larger the standard deviation, the shorter and wider the curve, while the smaller the standard deviation, the taller and more narrow the curve.

###

Given that $X\sim N\left(\mu, \sigma\right)$, we can compute probabilities associated with observed values of $X$ by finding the corresponding area beneath the normal curve with mean $\mu$ and standard deviation $\sigma$.

###

**Properties of the Normal Distribution:** We have the following properties associated with the normal distribution. Consider $X\sim N\left(\mu, \sigma\right)$.

+ The area beneath the entire distribution is 1 (since this is equivalent to the probability that $X$ takes on any of its possible values).

<center>
```{r shade-norm, echo = FALSE, eval = TRUE, message = FALSE, warning = FALSE, fig.width = 3, fig.height = 3}
ggplot(NULL, aes(c(-3, 3))) +
  geom_area(stat = "function", fun = dnorm, args = list(mean = 0, sd = 1), xlim = c(-3, 3), fill = "steelblue", alpha = 0.5) + geom_line(mapping = aes(x = seq(-3, 3, length.out = 200), y = dnorm(seq(-3, 3, length.out = 200), 0, 1)), color = "blue", lwd = 1.25) + xlab("") + ylab("") + ggtitle("The shaded area is 1") + scale_x_continuous(breaks = c(0), labels = c(expression(mu)))  + theme(axis.text.x = element_text(size = 14))
```
</center>

###

+ $\displaystyle{\mathbb{P}\left[X\leq \mu\right] = \mathbb{P}\left[X\geq \mu\right] = 0.5}$ (the area underneath a full half of the distribution is 0.5)

<center>
```{r shade-norm-half, echo = FALSE, eval = TRUE, message = FALSE, warning = FALSE, fig.width = 3, fig.height = 3}
ggplot(NULL, aes(c(-3, 3))) +
  geom_area(stat = "function", fun = dnorm, args = list(mean = 0, sd = 1), xlim = c(-3, 0), fill = "steelblue", alpha = 0.5) + geom_line(mapping = aes(x = seq(-3, 3, length.out = 200), y = dnorm(seq(-3, 3, length.out = 200), 0, 1)), color = "blue", lwd = 1.25) + xlab("") + ylab("") + ggtitle("The shaded area is 0.5") + scale_x_continuous(breaks = c(0), labels = c(expression(mu))) + theme(axis.text.x = element_text(size = 14))

ggplot(NULL, aes(c(-3, 3))) +
  geom_area(stat = "function", fun = dnorm, args = list(mean = 0, sd = 1), xlim = c(0, 3), fill = "steelblue", alpha = 0.5) + geom_line(mapping = aes(x = seq(-3, 3, length.out = 200), y = dnorm(seq(-3, 3, length.out = 200), 0, 1)), color = "blue", lwd = 1.25) + xlab("") + ylab("") + ggtitle("The shaded area is also 0.5") + scale_x_continuous(breaks = c(0), labels = c(expression(mu))) + theme(axis.text.x = element_text(size = 14))
```
</center>

###

+ The distribution is symmetric. In symbols, $\mathbb{P}\left[X\leq \mu - k\right] = \mathbb{P}\left[X \geq \mu + k\right]$ for any $k$.

<center>
```{r shade-norm-symmetric, echo = FALSE, eval = TRUE, message = FALSE, warning = FALSE, fig.width = 3, fig.height = 3}
ggplot(NULL, aes(c(-3, 3))) +
  geom_area(stat = "function", fun = dnorm, args = list(mean = 0, sd = 1), xlim = c(-3, -1.25), fill = "steelblue", alpha = 0.5) + geom_line(mapping = aes(x = seq(-3, 3, length.out = 200), y = dnorm(seq(-3, 3, length.out = 200), 0, 1)), color = "blue", lwd = 1.25) + xlab("") + ylab("") + ggtitle("A shaded area in the left \ntail") + scale_x_continuous(breaks = c(0, -1.25), labels = c(expression(mu), expression(mu - k))) + theme(axis.text.x = element_text(size = 14))

ggplot(NULL, aes(c(-3, 3))) +
  geom_area(stat = "function", fun = dnorm, args = list(mean = 0, sd = 1), xlim = c(1.25, 3), fill = "steelblue", alpha = 0.5) + geom_line(mapping = aes(x = seq(-3, 3, length.out = 200), y = dnorm(seq(-3, 3, length.out = 200), 0, 1)), color = "blue", lwd = 1.25) + xlab("") + ylab("") + ggtitle("The same shaded area in the \nright tail") + scale_x_continuous(breaks = c(0, 1.25), labels = c(expression(mu), expression(mu + k))) + theme(axis.text.x = element_text(size = 14))
```
</center>

###

+ $\displaystyle{\mathbb{P}\left[X = k\right] = 0}$ (the probability that $X$ takes on any prescribed value exactly is $0$)

<center>
```{r shade-norm-exact, echo = FALSE, eval = TRUE, message = FALSE, warning = FALSE, fig.width = 3, fig.height = 3}
ggplot(NULL, aes(c(-3, 3))) +
  geom_area(stat = "function", fun = dnorm, args = list(mean = 0, sd = 1), xlim = c(0.98, 1.02), fill = "steelblue", alpha = 0.5) + geom_line(mapping = aes(x = seq(-3, 3, length.out = 200), y = dnorm(seq(-3, 3, length.out = 200), 0, 1)), color = "blue", lwd = 1.25) + xlab("") + ylab("") + ggtitle("The area is 0") + ylim(c(0, 0.42)) + scale_x_continuous(breaks = c(0, 1), labels = c(expression(mu), "k")) + theme(axis.text.x = element_text(size = 14))
```
</center>

###

Sometimes it is useful to be able to estimate probabilities or to estimate the proportion of a population that falls into a range as long as the population is nearly normal. A convenient rule of thumb is the *Empirical Rule*.

**The Empirical Rule:** If $X\sim N\left(\mu, \sigma\right)$, then

+ $\mathbb{P}\left[\mu - \sigma \leq X\leq \mu + \sigma\right] \approx 0.67$ -- that is, about 67% of observations lie within one standard deviation of the mean.
+ $\mathbb{P}\left[\mu - 2\sigma \leq X\leq \mu + 2\sigma\right] \approx 0.95$ -- that is, about 95% of observations lie within two standard deviations of the mean.
+ $\mathbb{P}\left[\mu - 3\sigma \leq X\leq \mu + 3\sigma\right] \approx 0.997$ -- that is, about 99.7% of observations lie within three standard deviations of the mean.

###

For each of the following, assume that $X\sim N\left(\mu = 85, \sigma = 5\right)$

```{r empirical-rule-questions, echo = FALSE}
quiz(
  question_radio(
    "Use the *Empirical Rule* to approximate $\\mathbb{P}\\left[80\\leq X\\leq 90\\right]$",
    answer("50%"),
    answer("67%", correct = TRUE),
    answer("95%"),
    answer("Nearly 100%"),
    answer("It is impossible to tell"),
    allow_retry = TRUE
  ),
  question_checkbox(
    "According to the *Empirical Rule* which of the following are boundary values for which we expect about 95% of observed values of X will fall between?",
    answer("0"),
    answer("50"),
    answer("75", correct = TRUE),
    answer("80"),
    answer("90"),
    answer("95", correct = TRUE),
    answer("100"),
    allow_retry = TRUE
  )
)
```

## Standardization and $z$-scores

**Scenario:** Two students, Bob and Sally, are trying to compare how well they did on a college entrance exam. The difficulty comes in that Bob took the SAT which is known to follow an approximate normal distribution with a mean score of 1068 and a standard deviation of 210 while Sally took the ACT which also follows an approximately normal distribution but with a mean score of 20.8 and a standard deviation of 5.8. If Bob scored a 1400 on the SAT and Sally scored a 31 on the ACT, who scored relatively higher?

How do we answer this question? We'll see two methods.

### 

**Method 1:** We can standardize the test scores so that they have comparable units. 

+ **Definition:** If an observation $x$ comes from a nearly normal population with mean $\mu$ and standard deviation $\sigma$ then we compute $z$-score associated with $x$ as follows: 

$$\displaystyle{z = \frac{x - \mu}{\sigma}}$$

An observation's $z$-score is simply the number of standard deviations it falls above or below the mean. 

###

Use the code block below to compute Bob and Sally's $z$-scores and answer the questions that follow.

```{r compute-z-scores, exercise = TRUE}

```

```{r compute-z-scores-hint-1}
#Use the z-score formula, above.
```

```{r compute-z-scores-hint-2}
#Fill in the blanks
(___ - ___)/___
```

```{r compute-z-scores-hint-3}
#For Bob, we should have
(1400 - ___)/___
#Since Bob took the SAT, we need to use the 
#mean and standard deviation from that test 
#to find their z-score. Fill those in.
```

```{r compute-z-scores-hint-4}
#Bob's z-score is computed as follows:
(1400 - 1068)/210

```

```{r compute-z-scores-hint-5}
#Do the same for Sally, but use her ACT score, 
#along with the mean and standard deviation for 
#the ACT.
(___ - ___)/___

```

```{r SAT-ACT-z-scores, echo = FALSE}
quiz(
  question_radio(
    "Which of the following is the $z$-score corresponding to Bob? (round to two decimal places)",
    answer("1.58", correct = TRUE),
    answer("1394.91"),
    answer("-1.58"),
    answer("1.76"),
    answer("-1.76"),
    allow_retry = TRUE,
    random_answer_order = TRUE
  ),
  question_radio(
    "Which of the following is the $z$-score corresponding to Sally? (round to two decimal places)",
    answer("1.58"),
    answer("27.41"),
    answer("-1.58"),
    answer("1.76", correct = TRUE),
    answer("-1.76"),
    allow_retry = TRUE,
    random_answer_order = TRUE
  ),
  question_radio(
    "Who did relatively better on their standardized exam, Bob or Sally? Why?",
    answer("Sally, since her score is 1.76 standard deviations above the mean, while Bob's was only 1.58 standard deviations above the mean.", correct = TRUE),
    answer("Bob, since his $z$-score was 1.58 which is closer to the mean than Sally's $z$-score of 1.76."),
    answer("Bob, since his score was 1400 and Sally's score was only 31."),
    answer("Bob, since the SAT had a larger standard deviation it is a harder exam."),
    allow_retry = TRUE,
    random_answer_order = TRUE
  )
)
```

###

**A recap on $z$-scores:** We can use $z$-scores as a common unit for comparing observations from completely different populations (such as SAT scores and ACT scores). Here's a recap of the most important information so far:

+ If an observation $x$ comes from a nearly normal population with mean $\mu$ and standard deviation $\sigma$, we can compute it's $z$-score using the formula: $\displaystyle{z = \frac{x - \mu}{\sigma}}$.
+ A $z$-score measures the number of standard deviations which an observation falls above or below the mean.

  + A positive $z$-score means that an observation was above the mean.
  + A negative $z$-score means that an observation was below the mean.
  + The larger a $z$-score is in absolute value, the further the corresponding observation falls from the mean. That is, the larger the magnitude of a $z$-score, the further into the tail of the distribution the corresponding observation falls.
  
###

**Method 2:** We can compute the *percentile* corresponding to Bob's SAT score and the *percentile* corresponding to Sally's ACT score.
  
  + **Definition:** Given an observation $x$ from a population -- the *percentile* corresponding to $x$ is the proportion of the population which falls below $x$.
  
###

<div class = "row">
<div class = "col-md-6">
Bob's percentile corresponds to the shaded area in the distribution below.

```{r bob-SAT-percentile, echo = FALSE, eval = TRUE, message = FALSE, warning = FALSE, results = FALSE, fig.width = 3, fig.height = 3}
ggplot(NULL, aes(c(500, 1600))) +
  geom_area(stat = "function", fun = dnorm, args = list(mean = 1068, sd = 210), xlim = c(500, 1400), fill = "steelblue", alpha = 0.5) + geom_line(mapping = aes(x = seq(500, 1600, length.out = 200), y = dnorm(seq(500, 1600, length.out = 200), 1068, 210)), color = "blue", lwd = 1.25) + xlab("") + ylab("") + ggtitle("SAT Distribution") + xlim(c(500, 1600)) + scale_x_continuous(breaks = c(1068, 1400), labels = c(expression(mu = 1068), "Bob")) + theme(axis.text.x = element_text(size = 14))
```
</div>
<div class = "col-md-6">
Sally's percentile corresponds to the shaded area in the distribution below.

```{r sally-SAT-percentile, echo = FALSE, eval = TRUE, message = FALSE, warning = FALSE, results = FALSE, fig.width = 3, fig.height = 3}
ggplot(NULL, aes(c(0, 36))) +
  geom_area(stat = "function", fun = dnorm, args = list(mean = 20.8, sd = 5.8), xlim = c(0, 31), fill = "steelblue", alpha = 0.5) + geom_line(mapping = aes(x = seq(0, 36, length.out = 200), y = dnorm(seq(0, 36, length.out = 200), 20.8, 5.8)), color = "blue", lwd = 1.25) + xlab("") + ylab("") + ggtitle("ACT Distribution") + xlim(c(0, 36)) + scale_x_continuous(breaks = c(20.8, 31), labels = c(expression(mu = 20.8), "Sally")) + theme(axis.text.x = element_text(size = 14))
```
</div>
</div>

### 

There are many ways to compute percentiles. Before the widespread availability of statistical software, people converted observed values to $z$-scores and then looked up the percentile in a table. Luckily R provides nice functionality for computing percentiles.

**Computing Percentiles in R:** If $X\sim N\left(\mu, \sigma\right)$, then 
$$\mathbb{P}\left[X\leq q\right] \approx \tt{pnorm(q, mean = \mu, sd = \sigma)}$$

###

The block below is preset to compute the Bob's percentile. Execute the code cell and then adapt the code to find Sally's percentile. Use your results to answer the questions below.

```{r compute-percentiles, exercise = TRUE}
pnorm(1400, 1068, 210)
```

```{r compute-percentiles-hint-1}
#Just run this code to compute Bob's percentile
pnorm(1400, 1068, 210)

```

```{r compute-percentiles-hint-2}
#The arguments for pnorm() are, in order:
####boundary value,
####distribution mean
####distribution standard deviation
pnorm(1400, 1068, 210)

```

```{r compute-percentiles-hint-3}
#Fill in the blanks with the following to find
#Sally's percentile:
####Sally's ACT score (the boundary value)
####the mean ACT score
####the standard deviation in ACT scores
pnorm(___, ___, ___)

```

```{r SAT-ACT-percentiles, echo = FALSE}
quiz(
  question_radio(
    "Which of the following is the percentile corresponding to Bob? (round to four decimal places)",
    answer("0.9431", correct = TRUE),
    answer("0.0569"),
    answer("0.4431"),
    answer("0.9608"),
    answer("0.0392"),
    allow_retry = TRUE,
    random_answer_order = TRUE
  ),
  question_radio(
    "Which of the following is the percentile corresponding to Sally? (round to two decimal places)",
    answer("0.9431"),
    answer("0.0569"),
    answer("0.4431"),
    answer("0.9607", correct = TRUE),
    answer("0.0392"),
    allow_retry = TRUE,
    random_answer_order = TRUE
  ),
  question_radio(
    "Who did relatively better on their standardized exam, Bob or Sally? Why?",
    answer("Sally, since she scored in a higher percentile than Bob", correct = TRUE),
    answer("Bob, since he scored in a lower percentile than Sally"),
    answer("Bob, since he scored closer to the mean"),
    answer("Bob, since his percentile score was so high even though the standard deviation on the SAT was so large."),
    allow_retry = TRUE,
    random_answer_order = TRUE
  )
)
```

###

We'll make good use of this second method for a while, but don't forget about standardization and $z$-scores. We'll need that strategy quite often later in our course! For now, let's move on to practicing with finding probabilities from a normal distribution using R's `pnorm()` function.

## Computing probability from a normal distribution

Through this section you'll be getting practice finding probabilities by using R's `pnorm()` function to compute areas. Remember that the `pnorm()` function takes three arguments -- the first is a $\tt{boundary}$ value, the second is the $\tt{mean}$ of the distribution, and the third is the $\tt{standard~deviation}$. The value returned by `pnorm()` is the area to the <u>left</u> of the provided boundary value in the distribution with the mean and standard deviation you provided.

###

For these first few questions I'll draw pictures for you, but you should be prepared to draw your own shortly.

###

<div class = "row">
<div class = "col-md-6">

**Question 1:** Use the code block below to find $\mathbb{P}\left[Z < \right.$ `r boundary1` $\left.\right]$ -- Remember that $Z\sim N\left(\mu = 0, \sigma = 1\right)$.

```{r pnorm-ex1-left, exercise = TRUE}

```

```{r pnorm-ex1-left-hint-1}
#I've drawn the picture for you below.
#(Be sure you can answer: Why does this 
#picture correspond to the probability 
#requested?)
```

```{r pnorm-ex1-left-hint-2}
#Use the pnorm() function with the boundary of
#the shaded region as the first argument, the 
#mean of the normal distribution as the second
#argument, and the standard deviation of the 
#normal distribution as the final argument.

pnorm(___, ___, ___)

```

```{r pnorm-ex1-left-hint-3}
#The notation Z ~ N(mu = 0, sigma = 1) indicates 
#that the mean (mu) of this distribution is 0
#and that the standard deviation (sigma) of the 
#distribution is 1.

pnorm(___, ___, ___)

```

```{r pnorm-ex1-left-solution}
pnorm(1.49, 0, 1)
```

```{r pnorm-ex1-left-check}
grade_result(
  pass_if(~ (abs(.result - pnorm(boundary1, 0, 1)) < 0.001))
)
```
</div>
<div class = "col-md-5">
```{r pnorm-ex1-left-plot, echo = FALSE, eval = TRUE, message = FALSE, warning = FALSE, results = FALSE, fig.width = 3, fig.height = 3}
ggplot(NULL, aes(c(-3, 3))) +
  geom_area(stat = "function", fun = dnorm, args = list(mean = 0, sd = 1), xlim = c(-3, boundary1), fill = "steelblue", alpha = 0.5) + geom_line(mapping = aes(x = seq(-3, 3, length.out = 200), y = dnorm(seq(-3, 3, length.out = 200), 0, 1)), color = "blue", lwd = 1.25) + xlab("") + ylab("") + ggtitle("") + xlim(c(-3, 3)) + scale_x_continuous(breaks = c(0, boundary1)) + theme(axis.text.x = element_text(size = 12, angle = 45))
```
</div>
</div>

###

<div class = "row">
<div class = "col-md-6">

**Question 2:** Find $\mathbb{P}\left[Z < \right.$ `r boundary2` $\left.\right]$.

```{r pnorm-ex2-left, exercise = TRUE}

```

```{r pnorm-ex2-left-hint-1}
#Again, I've drawn the picture for you here.
#Would you be able to draw the picture if I 
#hadn't provided it?
#Try practicing this picture-drawing skill -- 
#it will serve you well.

```

```{r pnorm-ex2-left-hint-2}
#If you haven't solved the question yet, how 
#"big" do you expect this probability to be?
#Should it be more than 0.5? Less than 0.5? Why?

```

```{r pnorm-ex2-left-hint-3}
#Remembering that the entire area under this 
#normal distribution is 1, and that the distribution 
#is symmetric (the left and right half are identical),
#we should expect our answer to be less than 0.5.
#This is because our shaded area covers less than 
#half of the entire distribution.

```

```{r pnorm-ex2-left-hint-4}
#Answer this question exactly the way you answered 
#the previous one. The boundary value here is 
#negative, but pnorm() will always give you the 
#area to the left of your provided boundary value.
#That's what you want here anyway, right?

```

```{r pnorm-ex2-left-hint-5}
#Fill in the blanks to find the answer:
pnorm(___, ___, ___)

```

```{r pnorm-ex2-left-check}
grade_result(
  pass_if(~ (abs(.result - pnorm(boundary2, 0, 1)) < 0.001))
)
```
</div>
<div class = "col-md-5">
```{r pnorm-ex2-left-plot, echo = FALSE, eval = TRUE, message = FALSE, warning = FALSE, results = FALSE, fig.width = 3, fig.height = 3}
ggplot(NULL, aes(c(-3, 3))) +
  geom_area(stat = "function", fun = dnorm, args = list(mean = 0, sd = 1), xlim = c(-3, boundary2), fill = "steelblue", alpha = 0.5) + geom_line(mapping = aes(x = seq(-3, 3, length.out = 200), y = dnorm(seq(-3, 3, length.out = 200), 0, 1)), color = "blue", lwd = 1.25) + xlab("") + ylab("") + ggtitle("") + xlim(c(-3, 3)) + scale_x_continuous(breaks = c(0, boundary2)) + theme(axis.text.x = element_text(size = 12, angle = 45))
```
</div>
</div>

###

<div class = "row">
<div class = "col-md-6">

**Question 3:** Find $\mathbb{P}\left[Z > \right.$ `r boundary3` $\left.\right]$.

```{r pnorm-ex3-right, exercise = TRUE}

```

```{r pnorm-ex3-right-hint-1}
#This one is similar to the previous two questions.
#What is different about it, though?

```

```{r pnorm-ex3-right-hint-2}
#The shaded area is to the right of the 
#boundary value.

```

```{r pnorm-ex3-right-hint-3}
#The pnorm() function gives us the area to the 
#*left* of our boundary value, not the area 
#to the right of it! Can we still find a way 
#to use pnorm()?

```

```{r pnorm-ex3-right-hint-4}
#In a previous notebook, we started with a probability
#that we knew was too big, and removed the 
#probability associated with events we weren't 
#interested in so that we were left with the 
#probability of only the events we wanted.
#Can we apply those same ideas here?

```

```{r pnorm-ex3-right-hint-5}
#If we start with the entire area under the normal 
#curve and remove the unshaded area, then we 
#should be left with just the shaded area.

```

```{r pnorm-ex3-right-hint-6}
#Fill in the blanks to answer the question:

___ - ___(___, ___, ___)

```

```{r pnorm-ex3-right-hint-7}
#To fill in the leftmost blank, what is the area
#under the entire normal distribution equal to?
#That is, if we shaded in the entire distribution, 
#what probability would that represent? 
___ - ___(___, ___, ___)

```

```{r pnorm-ex3-right-hint-8}
#Shading the entire distribution amounts to 
#considering all possible outcomes. The probability
#of observing one of the possible outcomes is 1
#(or 100%).
1 - ___(___, ___, ___)

```

```{r pnorm-ex3-right-hint-9}
#We know that 1 (or 100%) is too large because we see 
#unshaded area. The probability we are looking for is 
#less than 100%. How do you subtract out the probability 
#of observing an outcome to the left of -2.17?
1 - ___(___, ___, ___)

```

```{r pnorm-ex3-right-hint-10}
#The distribution we are working with is still 
#a normal distribution. 

1 - ___(___, ___, ___)

```

```{r pnorm-ex3-right-hint-11}
#Apply what you've done in the previous 
#two questions to identify the area to the left 
#of the boundary value -2.17 as what will be subtracted away.

1 - pnorm(___, ___, ___)

```

```{r pnorm-ex3-right-solution}
1 - pnorm(-2.17, 0, 1)

```

```{r pnorm-ex3-right-check}
grade_result(
  pass_if(~ (abs(.result - (1 - pnorm(boundary3, 0, 1))) < 0.001))
)
```
</div>
<div class = "col-md-5">
```{r pnorm-ex3-right-plot, echo = FALSE, eval = TRUE, message = FALSE, warning = FALSE, results = FALSE, fig.width = 3, fig.height = 3}
ggplot(NULL, aes(c(-3, 3))) +
  geom_area(stat = "function", fun = dnorm, args = list(mean = 0, sd = 1), xlim = c(boundary3, 3), fill = "steelblue", alpha = 0.5) + geom_line(mapping = aes(x = seq(-3, 3, length.out = 200), y = dnorm(seq(-3, 3, length.out = 200), 0, 1)), color = "blue", lwd = 1.25) + xlab("") + ylab("") + ggtitle("") + xlim(c(-3, 3)) + scale_x_continuous(breaks = c(0, boundary3)) + theme(axis.text.x = element_text(size = 12, angle = 45))
```
</div>
</div>

###

<div class = "row">
<div class = "col-md-6">

**Question 4:** Find $\mathbb{P}\left[Z > \right.$ `r boundary4` $\left.\right]$.

```{r pnorm-ex4-right, exercise = TRUE}

```

```{r pnorm-ex4-right-hint-1}
#Take the same approach as you used to answer
#the previous question.

```

```{r pnorm-ex4-right-hint-2}
#How "big" should your answer be? More than 0.5?
#Less than 0.5? How do you know?

```

```{r pnorm-ex4-right-hint-3}
#To compute the probability to the right of 
#your boundary value, subtract the probability
#to the left of the boundary value away from 1.

```

```{r pnorm-ex4-right-hint-4}
#Fill in the blanks
___ - ___(___, ___, ___)

```

```{r pnorm-ex4-right-check}
grade_result(
  pass_if(~ (abs(.result - (1 - pnorm(boundary4, 0, 1))) < 0.001))
)
```
</div>
<div class = "col-md-5">
```{r pnorm-ex4-right-plot, echo = FALSE, eval = TRUE, message = FALSE, warning = FALSE, results = FALSE, fig.width = 3, fig.height = 3}
ggplot(NULL, aes(c(-3, 3))) +
  geom_area(stat = "function", fun = dnorm, args = list(mean = 0, sd = 1), xlim = c(boundary4, 3), fill = "steelblue", alpha = 0.5) + geom_line(mapping = aes(x = seq(-3, 3, length.out = 200), y = dnorm(seq(-3, 3, length.out = 200), 0, 1)), color = "blue", lwd = 1.25) + xlab("") + ylab("") + ggtitle("") + xlim(c(-3, 3)) + scale_x_continuous(breaks = c(0, boundary4)) + theme(axis.text.x = element_text(size = 12, angle = 45))
```
</div>
</div>

###

<div class = "row">
<div class = "col-md-6">

**Question 5:** Find $\mathbb{P}\left[\right.$ `r boundary5a` $< Z <$  `r boundary5b` $\left.\right]$.

```{r pnorm-ex5-mid, exercise = TRUE}

```

```{r pnorm-ex5-mid-hint-1}
#What makes this one different from all of the 
#previous questions?

```

```{r pnorm-ex5-mid-hint-2}
#Even our "subtract-from-one" trick won't work
#here, because pnorm() computes the area into the tail 
#of the distribution.

```

```{r pnorm-ex5-mid-hint-3}
#Starting with 1 and subtracting out the area 
#we don't want won't easily work here.
#
#Remember, we started with 1 and subtracted in the previous 
#two questions because we knew that an area of 1 was
#"too big".

```

```{r pnorm-ex5-mid-hint-4}
#Is there a way we could compute an area that 
#is too big to start? We want the area we compute
#to share a boundary with the shaded area we are
#ultimately trying to find. See the picture for reference.

```

```{r pnorm-ex5-mid-hint-5}
#Fill in the blanks to compute an area that's too big,
#to start.

___(___, ___, ___)

```

```{r pnorm-ex5-mid-hint-6}
#One of the areas below is the one to start with...
#which one is it, and why?

pnorm(2.08, 0, 1)
pnorm(-1.04, 0, 1)

```

```{r pnorm-ex5-mid-hint-7}
#Starting with pnorm(2.08, 0, 1) gives us an 
#area that is bigger than what we want. Take out a 
#piece of paper and draw/shade the region corresponding 
#to the value of pnorm(2.08, 0, 1)

pnorm(2.08, 0, 1)

```

```{r pnorm-ex5-mid-hint-8}
#From your picture, you should be able to visually 
#confirm that the area computed by pnorm(2.08, 0, 1)
#is larger than the area you want to find. You should 
#also be able to see that your picture and the 
#picture I drew in this notebook share a boundary
#though.

pnorm(2.08, 0, 1)

```

```{r pnorm-ex5-mid-hint-9}
#Can you remove some of the shaded area from your 
#picture in order to obtain the shaded area we want?
#Removing shaded area amounts to subtraction.

pnorm(2.08, 0, 1) - ___

```

```{r pnorm-ex5-mid-hint-10}
#Here's a slightly better hint. Fill in the blanks.

pnorm(2.08, 0, 1) - ___(___, ___, ___)

```

```{r pnorm-ex5-mid-hint-11}
#The area you are subtracting still falls under a 
#normal distribution with mean 0 and standard deviation 1.

pnorm(2.08, 0, 1) - pnorm(___, 0, 1)

```

```{r pnorm-ex5-mid-hint-12}
#What is the boundary value corresponding to the 
#region you'd like to "unshade" from your picture
#in order to obtain the picture in this notebook?

pnorm(2.08, 0, 1) - pnorm(___, 0, 1)

```

```{r pnorm-ex5-mid-solution}
pnorm(2.08, 0, 1) - pnorm(-1.04, 0, 1)

```

```{r pnorm-ex5-mid-check}
grade_result(
  pass_if(~ (abs(.result - (pnorm(boundary5b, 0, 1) - pnorm(boundary5a, 0, 1))) < 0.001))
)
```
</div>
<div class = "col-md-5">
```{r pnorm-ex5-mid-plot, echo = FALSE, eval = TRUE, message = FALSE, warning = FALSE, results = FALSE, fig.width = 3, fig.height = 3}
ggplot(NULL, aes(c(-3, 3))) +
  geom_area(stat = "function", fun = dnorm, args = list(mean = 0, sd = 1), xlim = c(boundary5a, boundary5b), fill = "steelblue", alpha = 0.5) + geom_line(mapping = aes(x = seq(-3, 3, length.out = 200), y = dnorm(seq(-3, 3, length.out = 200), 0, 1)), color = "blue", lwd = 1.25) + xlab("") + ylab("") + ggtitle("") + xlim(c(-3, 3)) + scale_x_continuous(breaks = c(boundary5a, 0, boundary5b)) + theme(axis.text.x = element_text(size = 12, angle = 45))
```
</div>
</div>

###

<div class = "row">
<div class = "col-md-6">

**Question 6:** Find $\mathbb{P}\left[Z < \right.$ `r boundary6a` $\text{ or } Z >$ `r boundary6b` $\left.\right]$.

```{r pnorm-ex6-out, exercise = TRUE}

```

```{r pnorm-ex6-out-hint-1}
#Again, something slightly different. How is this one
#different than the questions you've previously been
#asked? How is it similar to those questions?

```

```{r pnorm-ex6-out-hint-2}
#There are lots of way's to approach this one.
#My favorite is to compute the two areas separately
#and then add them together.

```

```{r pnorm-ex6-out-hint-3}
#Calculate the area to the left of the left-most 
#boundary value.

```

```{r pnorm-ex6-out-hint-4}
#Calculate the area to the right of the right-most 
#boundary value.


```

```{r pnorm-ex6-out-hint-5}
#You'll need your "subtract-from-one" trick here.

```

```{r pnorm-ex6-out-hint-6}
#Now that you have both areas, add them together
#to find the total shaded area.

```

```{r pnorm-ex6-out-check}
grade_result(
  pass_if(~ (abs(.result - (pnorm(boundary6a, 0, 1) +(1 - pnorm(boundary6b, 0, 1)))) < 0.001))
)
```
</div>
<div class = "col-md-5">
```{r pnorm-ex6-out-plot, echo = FALSE, eval = TRUE, message = FALSE, warning = FALSE, results = FALSE, fig.width = 3, fig.height = 3}
ggplot(NULL, aes(c(-3, 3))) +
  geom_area(stat = "function", fun = dnorm, args = list(mean = 0, sd = 1), xlim = c(-3, boundary6a), fill = "steelblue", alpha = 0.5) + geom_area(stat = "function", fun = dnorm, args = list(mean = 0, sd = 1), xlim = c(boundary6b, 3), fill = "steelblue", alpha = 0.5) + geom_line(mapping = aes(x = seq(-3, 3, length.out = 200), y = dnorm(seq(-3, 3, length.out = 200), 0, 1)), color = "blue", lwd = 1.25) + xlab("") + ylab("") + ggtitle("") + xlim(c(-3, 3)) + scale_x_continuous(breaks = c(boundary6a, 0, boundary6b)) + theme(axis.text.x = element_text(size = 12, angle = 45))
```
</div>
</div>

###

<div class = "row">
<div class = "col-md-6">

**Question 7:** Find $\mathbb{P}\left[\left|Z\right| > \right.$ `r boundary7` $\left.\right]$.

```{r pnorm-ex7-out, exercise = TRUE}

```

```{r pnorm-ex7-out-hint-1}
#Justifying the picture:
#Recall that |Z| denotes the "absolute value" of Z.
#The absolute value measures distance away from 0.
#Notice here, that we are interested in values of Z
#whose distance from 0 exceeds 2.03.

```

```{r pnorm-ex7-out-hint-2}
#You can answer this question in the same way as you 
#did for the previous question.
#Use the picture to guide you.

```

```{r pnorm-ex7-out-hint-3}
#It is even a little bit easier than that question if 
#you remember that our distribution is symmetric.

```

```{r pnorm-ex7-out-hint-4}
#What must be true about the area in the left tail 
#and the area in the right tail?

```

```{r pnorm-ex7-out-hint-5}
#Since they're the same, just calculate one of the areas
#and double it.

```

```{r pnorm-ex7-out-check}
grade_result(
  pass_if(~ (abs(.result - (pnorm(-boundary7, 0, 1) +(1 - pnorm(boundary7, 0, 1)))) < 0.001))
)
```
</div>
<div class = "col-md-5">
```{r pnorm-ex7-out-plot, echo = FALSE, eval = TRUE, message = FALSE, warning = FALSE, results = FALSE, fig.width = 3, fig.height = 3}
ggplot(NULL, aes(c(-3, 3))) +
  geom_area(stat = "function", fun = dnorm, args = list(mean = 0, sd = 1), xlim = c(-3, -boundary7), fill = "steelblue", alpha = 0.5) + geom_area(stat = "function", fun = dnorm, args = list(mean = 0, sd = 1), xlim = c(boundary7, 3), fill = "steelblue", alpha = 0.5) + geom_line(mapping = aes(x = seq(-3, 3, length.out = 200), y = dnorm(seq(-3, 3, length.out = 200), 0, 1)), color = "blue", lwd = 1.25) + xlab("") + ylab("") + ggtitle("") + xlim(c(-3, 3)) + scale_x_continuous(breaks = c(-boundary7, 0, boundary7)) + theme(axis.text.x = element_text(size = 12, angle = 45))
```
</div>
</div>

###

Through the last seven problems you only worked with the standard normal distribution -- that's the $Z$-distribution, which is $N\left(\mu = 0, \sigma = 1\right)$. We can find probabilities from arbitrary normal distributions (normal distributions with any mean and any standard deviation) using R's `pnorm()` functionality -- just supply the appropriate `mean` and `sd` arguments to `pnorm()` instead of the 0 and 1 that we passed earlier.

## Finding percentile cutoffs on a normal distribution

<div class = "row">
<div class = "col-md-7">
Recall from earlier that the $p^{th}$ percentile of a random variable $X$ is the value $x^*$ such that $\mathbb{P}\left[X < x^*\right] = p$.
</div>
<div class = "col-md-5">
```{r percentile-cutoff-def, echo = FALSE, eval = TRUE, message = FALSE, warning = FALSE, results = FALSE, fig.width = 3, fig.height = 3}
ggplot(NULL, aes(c(-3, 3))) +
  geom_area(stat = "function", fun = dnorm, args = list(mean = 0, sd = 1), xlim = c(-3, 1.96), fill = "steelblue", alpha = 0.5) + geom_line(mapping = aes(x = seq(-3, 3, length.out = 200), y = dnorm(seq(-3, 3, length.out = 200), 0, 1)), color = "blue", lwd = 1.25) + xlab("") + ylab("") + ggtitle("") + xlim(c(-3, 3)) + scale_x_continuous(breaks = c(0, 1.96), labels = c(expression(mu), "x*")) + theme(axis.text.x = element_text(size = 12))
```
</div>
</div>

###

If $X\sim N\left(\mu, \sigma\right)$, then to find the cutoff $x^*$ for which $\mathbb{P}\left[X < x^*\right] = p$, we can use R's `qnorm()` function. Similar to `pnorm()`, this function takes three arguments. The first is the $\tt{area~to~the~\underline{LEFT}~}$ of the desired cutoff, the second is the $\tt{mean}$ of the distribution, and the third is the $\tt{standard~deviation}$ of the distribution.

###

Recall from earlier that SAT scores followed $N\left(\mu = 1068, \sigma = 210\right)$ and ACT scores followed $N\left(\mu = 20.8, \sigma = 5.8\right)$. The code block below is set up to find the minimum required SAT score to fall in the 95th percentile (to do better than 95% of other test-takers). Execute the code and note the required score. Adapt the code to find the minimum ACT score required to fall into the top 10% of all ACT test takers. Does your answer seem right? How can you judge?

```{r find-percentile, exercise = TRUE, exercise.eval = FALSE}
qnorm(0.95, 1068, 210)
```

```{r find-percentile-hint-1}
#As mentioned, the arguments to the qnorm() function 
#are, in order:
####area to the LEFT of the desired cutoff (boundary)
####the mean of the normal distribution
####the standard deviation of the normal distribution

qnorm(0.95, 1068, 210)
```

```{r find-percentile-hint-2}
#Fill in the blanks in the second call to qnorm() to 
#reflect the ACT exam.

qnorm(0.95, 1068, 210)
qnorm(___, ___, ___)
```

```{r find-percentile-hint-3}
#Fill in the blanks in the second call to qnorm() to 
#reflect the ACT exam.

qnorm(0.95, 1068, 210)
qnorm(___, 20.8, 5.8)
```

```{r find-percentile-hint-4}
#The first argument is the area to the LEFT (the percentile) 
#of the desired cutoff score. What should this 
#area be if we want the *top* 10% of all scores?

qnorm(0.95, 1068, 210)
qnorm(___, 20.8, 5.8)
```

```{r find-percentile-solution}
qnorm(0.95, 1068, 210)
qnorm(0.9, 20.8, 5.8)
```

```{r find-percentile-check}
grade_result(
  pass_if(~ (abs(.result - qnorm(0.9, 20.8, 5.8)) < 0.1))
)
```

## Practice with the normal and binomial distributions

Through this last section you'll work through a set of problems, some of which use the normal distribution while others use the binomial distribution. It is up to you to determine which distribution should be applied in each problem. Below are a few helpful reminders:

+ The binomial distribution can be applied to scenarios of repeated trials, where each trial has two possible outcomes, and the probability of "success" on each trial remains constant (that is, trials are independent of one another). If we let $X$ be the number of successes observed in a binomial experiment with $n$ trials and a probability of success equal to $p$, then we have the following:
  
  + $\mathbb{P}\left[X = k\right] = \tt{dbinom(k, n, p)}$
  + $\mathbb{P}\left[X \leq k\right] = \tt{pbinom(k, n, p)}$

+ The normal distribution can be applied to scenarios where we know data follows at least a nearly-normal distribution. If $X\sim N\left(\mu, \sigma\right)$, then

  + $\mathbb{P}\left[X \leq k\right] = \tt{pnorm(k, mean = \mu, sd = \sigma)}$
  + If we wish to find the $p^{th}$ percentile of $X$ -- that is, we want to find the $\tt{boundary}$ value for which the probability of lying to the left is $p$, then we utilize $\tt{boundary = qnorm(p, mean = \mu, sd = \sigma)}$
  
###

**Practice Problem 1:** The National Vaccine Information Center estimates that 90% of Americans have had chickenpox by the time they reach adulthood. Suppose we take a random sample of `r chickPoxSampSize` American adults. Answer each of the following:

+ Compute the expected number of adults in our sample who will have had chickenpox.
```{r chick-pox-exp, exercise = TRUE}

```

```{r chick-pox-exp-hint-1}
#Is this scenario best-modeled by a binomial distribution,
#a normal distribution, or another distribution altogether?

```

```{r chick-pox-exp-hint-2}
#Notice that there are 68 adults being surveyed, they 
#are from a random sample (independent), and they are 
#each being asked a "yes or no" question -- "have you had 
#chickenpox?".

```

```{r chick-pox-exp-hint-3}
#This fits the assumptions of a binomial experiment 
#with 68 trials

```

```{r chick-pox-exp-hint-4}
#At the end of the Topic 5 notebook, you were introduced 
#to the expected value formula for binomial random variables.

```

```{r chick-pox-exp-hint-5}
#The formula for the expected value was n*p, where 
#n is the total number of trials, and p is the 
#probability of "success" on any given trial.

```

```{r chick-pox-exp-hint-6}
#We know that there are 68 trials (n = 68), what is the 
#probability that a randomly chosen adult has had chicken pox?

68*___
```

```{r chick-pox-exp-solution}
68*0.90

```

```{r chick-pox-exp-check}
grade_result(
  pass_if(~ (abs(.result - (chickPoxSampSize*0.9)) < 0.1))
)
```

+ Compute the standard deviation in number of adults in samples of size `r chickPoxSampSize` who will have had chickenpox.
```{r chick-pox-sd, exercise = TRUE}

```

```{r chick-pox-sd-hint-1}
#Similarly to the previous question, you were introduced
#to the formula for the standard deviation of a binomial
#random variable at the end of the Topic 5 notebook.

```

```{r chick-pox-sd-hint-2}
#The formula is: sqrt(n*p*(1 - p))

```

```{r chick-pox-sd-check}
grade_result(
  pass_if(~ (abs(.result - (sqrt(chickPoxSampSize*0.9*0.1))) < 0.1))
)
```

```{r surprised-if, echo = FALSE}
question_checkbox(
  paste0("Would you be surprised if your sample contained at most ", floor((chickPoxSampSize*0.9) - (3.5*sqrt(chickPoxSampSize*0.9*0.1))), " adults who have had chicken pox? Why? (select all that are appropriate)"),
  answer("Yes. This result would fall more than two standard deviations away from the expected value.", correct = TRUE),
  answer("Yes. If our assumptions are correct, the probability of this occurring would be less than 5%.", correct = TRUE),
  answer("Yes. We should be surprised by any result at all -- we can't know what will happen ahead of time."),
  answer("No. A result like this one is certainly possible."),
  answer("No. This result does not fall more than two standard deviations from the expected value."),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

While you answer the following questions, it might be useful to refer back to [the Game of Dreidel example and solution](www/BinomialExample.pdf){target="_blank"} from the Topic 5 notebook. To open the file, right-click (or `ctrl+click` on Mac) and choose to *open in a new tab*.

+ Find the probability that exactly `r floor(0.9*chickPoxSampSize)` adults in your sample of size `r chickPoxSampSize` will have had chickenpox. 
```{r chick-pox-prob-exact1, exercise = TRUE}

```

```{r chick-pox-prob-exact1-hint-1}
#We've accumulated four useful functions recently:
####dbinom()
####pbinom()
####pnorm()
####qnorm()

#Are any of them useful here?
```

```{r chick-pox-prob-exact1-hint-2}
#We can narrow it down to dbinom() or pbinom()
#since we know that we're working with a binomial
#random variable here.

```

```{r chick-pox-prob-exact1-hint-3}
#dbinom() is useful when we are interested in 
#observing **exactly** some specific number of successes

#pbinom() is most useful when we are interested in 
#observing **at most** some number of successes.

```

```{r chick-pox-prob-exact1-hint-4}
#The arguments to these functions are, in order:
####number of successes
####total number of trials
####probability of success

```

```{r chick-pox-prob-exact1-check}
grade_result(
  pass_if(~ (abs(.result - (dbinom(floor(0.9*chickPoxSampSize), chickPoxSampSize, 0.9))) < 0.001))
)
```

+ Find the probability that exactly `r floor(0.1*chickPoxSampSize)` adults in your sample of size `r chickPoxSampSize` will *not* have had chickenpox.
```{r chick-pox-prob-exact2, exercise = TRUE}

```

```{r chick-pox-prob-exact2-hint-1}
#This is a lot like the previous question.

```

```{r chick-pox-prob-exact2-hint-2}
#...but read carefully.

```

```{r chick-pox-prob-exact2-hint-3}
#What is the probability that a randomly selected adult
#has **not** had chickenpox?

```

```{r chick-pox-prob-exact2-check}
grade_result(
  pass_if(~ (abs(.result - (dbinom(floor(0.1*chickPoxSampSize), chickPoxSampSize, 0.1))) < 0.001))
)
```

+ Find the probability that at most `r floor(0.75*chickPoxSampSize)` adults in your sample of size `r chickPoxSampSize` will have had chicken pox.
```{r chick-pox-prob-atmost, exercise = TRUE}

```

```{r chick-pox-prob-atmost-hint-1}
#Are you interested in **exactly** some number of 
#successes here?

```

```{r chick-pox-prob-atmost-hint-2}
#Use pbinom() instead of dbinom()

```

```{r chick-pox-prob-atmost-check}
grade_result(
  pass_if(~ (abs(.result - (pbinom(floor(0.75*chickPoxSampSize), chickPoxSampSize, 0.9))) < 0.00005))
)
```

+ Find the probability that at least `r floor(0.95*chickPoxSampSize)` adults in your sample of size `r chickPoxSampSize` will have had chicken pox.
```{r chick-pox-prob-atleast, exercise = TRUE}

```

```{r chick-pox-prob-atleast-hint-1}
#We are interested in several possible outcomes 
#here. The pbinom() function is better-suited to this 
#scenario than dbinom() is.

```

```{r chick-pox-prob-atleast-hint-2}
#The pbinom() function computes the probability of 
# **at most** some number of successes, not at least some 
#number of successes. Draw a picture to help you, and 
#use the "subtract-from-one" approach.

```

```{r chick-pox-prob-atleast-check}
grade_result(
  pass_if(~ (abs(.result - ( 1 - pbinom((floor(0.95*chickPoxSampSize) - 1), chickPoxSampSize, 0.9))) < 0.0001))
)
```

+ Find the probability that more than `r floor(0.8*chickPoxSampSize)` but less than `r floor(0.9*chickPoxSampSize)` adults in your sample of size `r chickPoxSampSize` will have had chicken pox.
```{r chick-pox-prob-between, exercise = TRUE}

```

```{r chick-pox-prob-between-hint-1}
#Since multiple outcomes are of interest here, we'll 
#stick with the pbinom() function.

```

```{r chick-pox-prob-between-hint-2}
#Draw a picture to help you. You'll need to use 
#the pbinom() function twice.

```

```{r chick-pox-prob-between-check}
grade_result(
  pass_if(~ (abs(.result - ( pbinom((floor(0.9*chickPoxSampSize) - 1), chickPoxSampSize, 0.9) - pbinom(floor(0.8*chickPoxSampSize), chickPoxSampSize, 0.9))) < 0.0001))
)
```

**Practice Problem 2:** Sophia took the Graduate Record Examination (GRE) and scored 160 on the Verbal Reasoning section and 157 on the Quantitative Reasoning section. The mean score on the Verbal Reasoning section for all test takers was 151 with a standard deviation of 7, and the mean score for the Quantitative Reasoning section for all test takers was 153 with a standard deviation of 7.67. Suppose we can assume that both score distributions are nearly normal.

+ Use the code block below to compute Sophia's $z$-score on the Quantitative Reasoning exam.
```{r z-score-QR, exercise = TRUE}

```

```{r z-score-QR-hint-1}
#Remember the z-score formula is: 
####(observation - mean)/(standard deviation)

```

```{r z-score-QR-hint-2}
#Be sure to use the values from the Quantitative
#Reasoning exam.

```

```{r z-score-QR-check}
grade_result(
  pass_if(~ (abs(.result - ((157 - 153)/7.67)) < 0.01))
)
```

+ Use the code block below to compute Sophia's $z$-score on the Verbal Reasoning exam.
```{r z-score-VR, exercise = TRUE}

```

```{r z-score-VR-hint-1}
#Use the same approach as above, but use the 
#values for the Verbal Reasoning Exam instead.

```

```{r z-score-VR-check}
grade_result(
  pass_if(~ (abs(.result - ((160 - 151)/7)) < 0.01))
)
```

```{r GRE-compare-zscore, echo = FALSE}
question_radio(
  "What do these z-scores tell you?",
  answer("Sophia scored relatively higher on the Verbal Reasoning exam since her  Verbal Reasoning z-score was larger.", correct = TRUE),
  answer("Sophia scored relatively higher on the Quantitative Reasoning exam since her Quantitative Reasoning z-score was larger."),
  answer("Sophia scored relatively higher on the Quantitative Reasoning exam since her Quantitative Reasoning z-score was closer to 0."),
  answer("It is impossible to tell which exam Sophia performed better on since the means and standard deviations of the score distributions are different."),
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

+ Find the proportion of test takers Sophia scored higher than on the Quantitative Reasoning exam (that is, find her percentile).
```{r GRE-QR-percentile, exercise = TRUE}

```

```{r GRE-QR-percentile-hint-1}
#What distribution are we using? Binomial? Normal?
#Another distribution altogether?

```

```{r GRE-QR-percentile-hint-2}
#Since we know that scores are approximately normally 
#distributed, we can use our normal distribution functions.

```

```{r GRE-QR-percentile-hint-3}
#Which one is appropriate here, pnorm() or qnorm()? Why?

```

```{r GRE-QR-percentile-hint-4}
#Draw your picture and shade it in. Use the picture to 
#help you fill in the parameters of the function you use.

```

```{r GRE-QR-percentile-check}
grade_result(
  pass_if(~ (abs(.result - pnorm(157, 153, 7.67)) < 0.001))
)
```

+ Find the proportion of test takers doing *better than* Sophia on the Verbal Reasoning exam.
```{r GRE-VR-percent-above, exercise = TRUE}

```

```{r GRE-VR-percent-above-hint-1}
#Again, draw a picture and use your picture to guide you.

```

```{r GRE-VR-percent-above-check}
grade_result(
  pass_if(~ (abs(.result - (1 - pnorm(160, 151, 7))) < 0.001))
)
```

## Submit

```{r context="server"}
learnrhash::encoder_logic(strip_output = TRUE)
```

```{r encode, echo=FALSE}
learnrhash::encoder_ui(
  ui_before = shiny::div(
    "If your instructor is asking you to submit evidence of your completed notebook using a hash code, you may generate that code below. Use the clipboard icon to ensure that you are copying the entire hash."
    )
  )
```

## Summary

Nice job getting through this workbook. Your hard work here will pay off as we move through much of the remainder of our course. Here are the major points we touched on.

+ A normal distribution is approximately bell-shaped and can be described by its mean $\mu$ and standard deviation $\sigma$. 
+ As a shorthand, we often write $N\left(\mu, \sigma\right)$ to mean the normal distribution with mean $\mu$ and standard deviation $\sigma$.
+ The *Empirical Rule* is a "rule of thumb" that states that, if data is normally distributed we expect:

  + Approximately 67% of observations fall within one standard deviation of the mean.
  + Approximately 95% of observations fall within two standard deviations of the mean.
  + Approximately 99.7% of observations fall within three standard deviations of the mean.

+ We can interpret areas underneath the normal distribution to be probabilities.
+ If $X\sim N\left(\mu, \sigma\right)$, then $\mathbb{P}\left[X\leq k\right] = \tt{pnorm(k, mean = \mu, sd = \sigma)}$

  + Remember that $\tt{pnorm()}$ always returns the area to the <u>left</u> of the boundary value $k$.
+ If $X\sim N\left(\mu, \sigma\right)$, then the $p^{th}$ percentile of $X$ (the cutoff for which the proportion of the population falling below is $p$), is given by $\tt{qnorm(p, mean = \mu, sd = \sigma)}$

  + Remember that $p$ must be the area to the <u>left</u> of the desired cutoff value.
